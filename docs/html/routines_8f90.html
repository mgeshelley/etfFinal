<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Extended Thomas-Fermi: srcs/routines.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Extended Thomas-Fermi
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('routines_8f90.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">routines.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespaceroutines"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html">routines</a></td></tr>
<tr class="memdesc:namespaceroutines"><td class="mdescLeft">&#160;</td><td class="mdescRight">Module to hold main routines: densities, energies. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a8146fb4359e556bad19f882b8aabfc4b"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b">routines::str2int</a> (string)</td></tr>
<tr class="separator:a8146fb4359e556bad19f882b8aabfc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d41e4cd4e61ac1463c75055bf784e8b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a0d41e4cd4e61ac1463c75055bf784e8b">routines::allocate_arrays</a> ()</td></tr>
<tr class="memdesc:a0d41e4cd4e61ac1463c75055bf784e8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to allocate arrays for all densities and effective masses, and for their derivatives.  <a href="namespaceroutines.html#a0d41e4cd4e61ac1463c75055bf784e8b">More...</a><br /></td></tr>
<tr class="separator:a0d41e4cd4e61ac1463c75055bf784e8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5caa9b33bdf3c960b6bb3bfa96771181"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a5caa9b33bdf3c960b6bb3bfa96771181">routines::initialise_uniform_mesh</a> ()</td></tr>
<tr class="memdesc:a5caa9b33bdf3c960b6bb3bfa96771181"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate number of mesh points for a uniform grid, allocate array for r, and then populate r with the mesh points.  <a href="namespaceroutines.html#a5caa9b33bdf3c960b6bb3bfa96771181">More...</a><br /></td></tr>
<tr class="separator:a5caa9b33bdf3c960b6bb3bfa96771181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27ad9ac802069004010c9759fecced92"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a27ad9ac802069004010c9759fecced92">routines::deallocate_mesh</a> ()</td></tr>
<tr class="memdesc:a27ad9ac802069004010c9759fecced92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to deallocate array for r.  <a href="namespaceroutines.html#a27ad9ac802069004010c9759fecced92">More...</a><br /></td></tr>
<tr class="separator:a27ad9ac802069004010c9759fecced92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7bc716d30ef4d9ecece5daa22324b77"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#ae7bc716d30ef4d9ecece5daa22324b77">routines::deallocate_arrays</a> ()</td></tr>
<tr class="memdesc:ae7bc716d30ef4d9ecece5daa22324b77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to deallocate arrays for all densities and effective masses, and for their derivatives.  <a href="namespaceroutines.html#ae7bc716d30ef4d9ecece5daa22324b77">More...</a><br /></td></tr>
<tr class="separator:ae7bc716d30ef4d9ecece5daa22324b77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a407a248748ce7c0e2e9e5dce03cc9415"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a407a248748ce7c0e2e9e5dce03cc9415">routines::calc_rho_q</a> (rhoqgas, rhoqliq, rq, aq, gammaq, r)</td></tr>
<tr class="memdesc:a407a248748ce7c0e2e9e5dce03cc9415"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the neutron or proton density at a given radius r, using supplied input parameters.  <a href="namespaceroutines.html#a407a248748ce7c0e2e9e5dce03cc9415">More...</a><br /></td></tr>
<tr class="separator:a407a248748ce7c0e2e9e5dce03cc9415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a701f911aa939448c5bee0589d57369ca"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a701f911aa939448c5bee0589d57369ca">routines::calc_f_q</a> (rhot, rhoq, q, fq)</td></tr>
<tr class="memdesc:a701f911aa939448c5bee0589d57369ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the effective mass ratio <img class="formulaInl" alt="$f_q=\frac{m}{m^*_q}$" src="form_13.png"/> for neutrons or protons, for standard Skyrme or for BSk forces.  <a href="namespaceroutines.html#a701f911aa939448c5bee0589d57369ca">More...</a><br /></td></tr>
<tr class="separator:a701f911aa939448c5bee0589d57369ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c520afea1e9ca6698a0792fbac37e7a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a8c520afea1e9ca6698a0792fbac37e7a">routines::calc_w_q</a> (delrho, delrhoq, Wq)</td></tr>
<tr class="memdesc:a8c520afea1e9ca6698a0792fbac37e7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the spin-orbit field <img class="formulaInl" alt="$\textbf{W}_q$" src="form_14.png"/> for neutrons or protons.  <a href="namespaceroutines.html#a8c520afea1e9ca6698a0792fbac37e7a">More...</a><br /></td></tr>
<tr class="separator:a8c520afea1e9ca6698a0792fbac37e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a421a5d2cca448f46b0dfb9bcdeec1111"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a421a5d2cca448f46b0dfb9bcdeec1111">routines::calc_tau_tf</a> (rhoq, tauTF)</td></tr>
<tr class="memdesc:a421a5d2cca448f46b0dfb9bcdeec1111"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the zeroth-order contribution to the kinetic energy density for neutrons or protons.  <a href="namespaceroutines.html#a421a5d2cca448f46b0dfb9bcdeec1111">More...</a><br /></td></tr>
<tr class="separator:a421a5d2cca448f46b0dfb9bcdeec1111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa80f6938f2b9c661821fa8956f8deef"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#aaa80f6938f2b9c661821fa8956f8deef">routines::calc_tau_2_l</a> (rhoq, delrhoq, del2rhoq, tau2Lq, t2contq)</td></tr>
<tr class="memdesc:aaa80f6938f2b9c661821fa8956f8deef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the local second-order contribution to the kinetic energy density for neutrons or protons.  <a href="namespaceroutines.html#aaa80f6938f2b9c661821fa8956f8deef">More...</a><br /></td></tr>
<tr class="separator:aaa80f6938f2b9c661821fa8956f8deef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72bf2988651a9f3251dfb338ad1a7eca"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a72bf2988651a9f3251dfb338ad1a7eca">routines::calc_tau_2_nl</a> (rhoq, delrhoq, fq, delfq, del2fq, Wq, q, tau2NLq, t2contq)</td></tr>
<tr class="memdesc:a72bf2988651a9f3251dfb338ad1a7eca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the non-local second-order contribution to the kinetic energy density for neutrons or protons.  <a href="namespaceroutines.html#a72bf2988651a9f3251dfb338ad1a7eca">More...</a><br /></td></tr>
<tr class="separator:a72bf2988651a9f3251dfb338ad1a7eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c7e02754e0ae8816b1bfeab92df6bc8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a9c7e02754e0ae8816b1bfeab92df6bc8">routines::calc_tau_4_no_spin</a> (rhoq, d1rhoq, d2rhoq, d3rhoq, d4rhoq, fq, d1fq, d2fq, d3fq, d4fq, tau4nospinq, t4contq)</td></tr>
<tr class="memdesc:a9c7e02754e0ae8816b1bfeab92df6bc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the fourth-order contributions to the kinetic energy density (without spin-orbit contributions) <img class="formulaInl" alt="$\textbf{tau}_q$" src="form_15.png"/> for neutrons or protons.  <a href="namespaceroutines.html#a9c7e02754e0ae8816b1bfeab92df6bc8">More...</a><br /></td></tr>
<tr class="separator:a9c7e02754e0ae8816b1bfeab92df6bc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8825f02bb2ac98507fff5024d9b54c8f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a8825f02bb2ac98507fff5024d9b54c8f">routines::calc_tau_4_so</a> (rhoq, d1rhoq, fq, d1fq, d2fq, d1Aq, d2Aq, d3Aq, q, tau_4_so_q, t4contq)</td></tr>
<tr class="memdesc:a8825f02bb2ac98507fff5024d9b54c8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the fourth-order contributions to the kinetic energy density (spin-orbit contributions) <img class="formulaInl" alt="$\textbf{tau}_q$" src="form_15.png"/> for neutrons or protons.  <a href="namespaceroutines.html#a8825f02bb2ac98507fff5024d9b54c8f">More...</a><br /></td></tr>
<tr class="separator:a8825f02bb2ac98507fff5024d9b54c8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af03f37f9deca52ef9a56287f50b982a1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#af03f37f9deca52ef9a56287f50b982a1">routines::calc_j_2_q</a> (rhoq, Wq, fq, q, J2q)</td></tr>
<tr class="memdesc:af03f37f9deca52ef9a56287f50b982a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the second-order contributions to the spin current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons.  <a href="namespaceroutines.html#af03f37f9deca52ef9a56287f50b982a1">More...</a><br /></td></tr>
<tr class="separator:af03f37f9deca52ef9a56287f50b982a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a014fed5fe5fbc19302e7cbc651ba59bd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a014fed5fe5fbc19302e7cbc651ba59bd">routines::calc_j_4_q</a> (rhoq, d1rhoq, fq, d1fq, d2fq, d1Aq, d2Aq, d3Aq, q, J4q)</td></tr>
<tr class="memdesc:a014fed5fe5fbc19302e7cbc651ba59bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the fourth-order contributions to the spin current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons.  <a href="namespaceroutines.html#a014fed5fe5fbc19302e7cbc651ba59bd">More...</a><br /></td></tr>
<tr class="separator:a014fed5fe5fbc19302e7cbc651ba59bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a136b7a1f0387466390decb98ce91c152"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a136b7a1f0387466390decb98ce91c152">routines::calc_div_j_2_q</a> (rhoq, d1rhoq, fq, d1fq, d1Aq, d2Aq, q, divJ2q)</td></tr>
<tr class="memdesc:a136b7a1f0387466390decb98ce91c152"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the second-order contributions to the divergence of the current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons.  <a href="namespaceroutines.html#a136b7a1f0387466390decb98ce91c152">More...</a><br /></td></tr>
<tr class="separator:a136b7a1f0387466390decb98ce91c152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f66729f05be35eda4266dbf47eda026"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a7f66729f05be35eda4266dbf47eda026">routines::calc_div_j_4_q</a> (rhoq, d1rhoq, d2rhoq, fq, d1fq, d2fq, d3fq, d1Aq, d2Aq, d3Aq, d4Aq, q, divJ4q)</td></tr>
<tr class="memdesc:a7f66729f05be35eda4266dbf47eda026"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the fourth-order contributions to the divergence of the current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons.  <a href="namespaceroutines.html#a7f66729f05be35eda4266dbf47eda026">More...</a><br /></td></tr>
<tr class="separator:a7f66729f05be35eda4266dbf47eda026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a44c591985c939162dabdeab4a4ced8"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a2a44c591985c939162dabdeab4a4ced8">routines::calc_u_q</a> (rhot, rhon, rhop, delrhot, delrhon, delrhop, del2rhot, del2rhon, del2rhop, taut, taun, taup, divJt, divJq, q)</td></tr>
<tr class="memdesc:a2a44c591985c939162dabdeab4a4ced8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the central potential <img class="formulaInl" alt="$U_q$" src="form_18.png"/> for neutrons or protons, for standard Skyrme or for BSk forces with extra terms.  <a href="namespaceroutines.html#a2a44c591985c939162dabdeab4a4ced8">More...</a><br /></td></tr>
<tr class="separator:a2a44c591985c939162dabdeab4a4ced8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa995449a9eb9c404dbd756bdbea180a2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2">routines::eval_fields</a> ()</td></tr>
<tr class="memdesc:aa995449a9eb9c404dbd756bdbea180a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives), spin-orbit fields, spin current densities (and derivatives)  <a href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2">More...</a><br /></td></tr>
<tr class="separator:aa995449a9eb9c404dbd756bdbea180a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97bfcff7e603cf9df3dcd48ae21b4612"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612">routines::eval_tau_etf</a> ()</td></tr>
<tr class="memdesc:a97bfcff7e603cf9df3dcd48ae21b4612"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the kinetic energy density <img class="formulaInl" alt="$\tau_{ETF}$" src="form_19.png"/> with the (extended) Thomas-Fermi approximation at order specified by "etf_order".  <a href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612">More...</a><br /></td></tr>
<tr class="separator:a97bfcff7e603cf9df3dcd48ae21b4612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb83677ec76758dadc35de4b01bac45c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#afb83677ec76758dadc35de4b01bac45c">routines::charge</a> (rho, Neutr, Nprot, Ngrid1, del1, rhoch)</td></tr>
<tr class="memdesc:afb83677ec76758dadc35de4b01bac45c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the charge density from the matter densities. Modified by M. Shelley.  <a href="namespaceroutines.html#afb83677ec76758dadc35de4b01bac45c">More...</a><br /></td></tr>
<tr class="separator:afb83677ec76758dadc35de4b01bac45c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74ed186c93b400a14428192e1cb7a0b2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a74ed186c93b400a14428192e1cb7a0b2">routines::eval_coulomb</a> (prot_dens, calc_exchange)</td></tr>
<tr class="memdesc:a74ed186c93b400a14428192e1cb7a0b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the Coulomb potentials and energy densities, using either the proton or charge density.  <a href="namespaceroutines.html#a74ed186c93b400a14428192e1cb7a0b2">More...</a><br /></td></tr>
<tr class="separator:a74ed186c93b400a14428192e1cb7a0b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b55cc503c7168299be63556e2602bd0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a0b55cc503c7168299be63556e2602bd0">routines::eval_electrons</a> ()</td></tr>
<tr class="memdesc:a0b55cc503c7168299be63556e2602bd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the proton-electron potential which contributes to <img class="formulaInl" alt="$U_q$" src="form_18.png"/>, all energy contributions, and the pressure, coming from a homogeneous electron gas. Also calculates the electron chemical potential.  <a href="namespaceroutines.html#a0b55cc503c7168299be63556e2602bd0">More...</a><br /></td></tr>
<tr class="separator:a0b55cc503c7168299be63556e2602bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ee5e5cd7ce81b013d18b19f5f9a4092"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a6ee5e5cd7ce81b013d18b19f5f9a4092">routines::eval_u_q</a> ()</td></tr>
<tr class="memdesc:a6ee5e5cd7ce81b013d18b19f5f9a4092"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the central fields <img class="formulaInl" alt="$U_q$" src="form_18.png"/>.  <a href="namespaceroutines.html#a6ee5e5cd7ce81b013d18b19f5f9a4092">More...</a><br /></td></tr>
<tr class="separator:a6ee5e5cd7ce81b013d18b19f5f9a4092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae210968d134fbcc79297971cc4fefb82"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#ae210968d134fbcc79297971cc4fefb82">routines::eval_skyrme_energy_density</a> ()</td></tr>
<tr class="memdesc:ae210968d134fbcc79297971cc4fefb82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the Skyrme energy density, after first separately evaluating the field energy density.  <a href="namespaceroutines.html#ae210968d134fbcc79297971cc4fefb82">More...</a><br /></td></tr>
<tr class="separator:ae210968d134fbcc79297971cc4fefb82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a383e2bf5a1fa37fbf95dd5f6ddbcc6be"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a383e2bf5a1fa37fbf95dd5f6ddbcc6be">routines::pressure</a> ()</td></tr>
<tr class="memdesc:a383e2bf5a1fa37fbf95dd5f6ddbcc6be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the nuclear contribution to the pressure, and then the total pressure.  <a href="namespaceroutines.html#a383e2bf5a1fa37fbf95dd5f6ddbcc6be">More...</a><br /></td></tr>
<tr class="separator:a383e2bf5a1fa37fbf95dd5f6ddbcc6be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8346e8e5457d6befb48b0ac56f4fdf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a0b8346e8e5457d6befb48b0ac56f4fdf">routines::calc_particle_number</a> ()</td></tr>
<tr class="memdesc:a0b8346e8e5457d6befb48b0ac56f4fdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the number of particles in the Wigner-Seitz cell.  <a href="namespaceroutines.html#a0b8346e8e5457d6befb48b0ac56f4fdf">More...</a><br /></td></tr>
<tr class="separator:a0b8346e8e5457d6befb48b0ac56f4fdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93de76f3b26ead66893f46dc4892dbcb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb">routines::eval_ws_quantities</a> ()</td></tr>
<tr class="memdesc:a93de76f3b26ead66893f46dc4892dbcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in the WS cell with densities <img class="formulaInl" alt="$rho_q$" src="form_20.png"/>.  <a href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb">More...</a><br /></td></tr>
<tr class="separator:a93de76f3b26ead66893f46dc4892dbcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f2a013c7bb06da429f995e288515248"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a8f2a013c7bb06da429f995e288515248">routines::calc_e_f_q</a> (rhoq, fq, q)</td></tr>
<tr class="memdesc:a8f2a013c7bb06da429f995e288515248"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the Fermi energy at a given density and effective mass, for neutrons or protons.  <a href="namespaceroutines.html#a8f2a013c7bb06da429f995e288515248">More...</a><br /></td></tr>
<tr class="separator:a8f2a013c7bb06da429f995e288515248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e52c281532c938dfa10d85404a367a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a92e52c281532c938dfa10d85404a367a">routines::d1</a> (n, h, f, df)</td></tr>
<tr class="memdesc:a92e52c281532c938dfa10d85404a367a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes the first derivative of function evaluated on the meshpoints 1,...,npt. The input is the function f with extrapolated values in -1, 0. Modified by M. Shelley.  <a href="namespaceroutines.html#a92e52c281532c938dfa10d85404a367a">More...</a><br /></td></tr>
<tr class="separator:a92e52c281532c938dfa10d85404a367a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc8447e9af12216ae995f63c1606f1a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#aafc8447e9af12216ae995f63c1606f1a">routines::d2</a> (n, h, f, d2f)</td></tr>
<tr class="memdesc:aafc8447e9af12216ae995f63c1606f1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes the second derivative of function evaluated on the meshpoints 1,...,npt. The input is the function f with extrapolated values in -1, 0. Modified by M. Shelley.  <a href="namespaceroutines.html#aafc8447e9af12216ae995f63c1606f1a">More...</a><br /></td></tr>
<tr class="separator:aafc8447e9af12216ae995f63c1606f1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a635a2461a6c20207dd3b268842381ce3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a635a2461a6c20207dd3b268842381ce3">routines::lap_sphe_symm</a> (f, df_dr, d2f_dr2)</td></tr>
<tr class="memdesc:a635a2461a6c20207dd3b268842381ce3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to carry out Laplacian in spherical symmetry.  <a href="namespaceroutines.html#a635a2461a6c20207dd3b268842381ce3">More...</a><br /></td></tr>
<tr class="separator:a635a2461a6c20207dd3b268842381ce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac563b00969cb307d71ebc02aaef0a3b4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#ac563b00969cb307d71ebc02aaef0a3b4">routines::d3</a> (f, d3f_dr3)</td></tr>
<tr class="memdesc:ac563b00969cb307d71ebc02aaef0a3b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate third derivative of function f evaluated on evenly-spaced meshpoints from 1 to n. Works with extrapolated values in -2,-1,0. Uses 7-point stencil.  <a href="namespaceroutines.html#ac563b00969cb307d71ebc02aaef0a3b4">More...</a><br /></td></tr>
<tr class="separator:ac563b00969cb307d71ebc02aaef0a3b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d38e9b19f2e939feb7840d2575fbb56"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a6d38e9b19f2e939feb7840d2575fbb56">routines::d4</a> (f, d4f_dr4)</td></tr>
<tr class="memdesc:a6d38e9b19f2e939feb7840d2575fbb56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate fourth derivative of function f evaluated on evenly-spaced meshpoints from 1 to n. Works with extrapolated values in -2,-1,0. Uses 7-point stencil.  <a href="namespaceroutines.html#a6d38e9b19f2e939feb7840d2575fbb56">More...</a><br /></td></tr>
<tr class="separator:a6d38e9b19f2e939feb7840d2575fbb56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af143340288720f8019e944ec7110a84e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#af143340288720f8019e944ec7110a84e">routines::extrapolate_back_3</a> (grid)</td></tr>
<tr class="memdesc:af143340288720f8019e944ec7110a84e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to extrapolate back 3 points on the r mesh, to faciliate the calculation of first and second derivatives using a 5-point stencil. Values in grid start at 4, extrapolated values are put in elements 3,2,1. Coefficients come from solving 4th-order polynomial, assuming that f'(0) = 0, and f(-h) = f(h).  <a href="namespaceroutines.html#af143340288720f8019e944ec7110a84e">More...</a><br /></td></tr>
<tr class="separator:af143340288720f8019e944ec7110a84e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5737b4327dcaa959a9ee519e4fca42e8"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8">routines::ws_integral</a> (quantity, n_max)</td></tr>
<tr class="memdesc:a5737b4327dcaa959a9ee519e4fca42e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to integrate a density or field over the whole W-S cell, using Simpson's rule (+ Simpson's 3/8 rule if odd number of points)  <a href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8">More...</a><br /></td></tr>
<tr class="separator:a5737b4327dcaa959a9ee519e4fca42e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81e61269fb96b5478fd7140a1f185ec1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a81e61269fb96b5478fd7140a1f185ec1">routines::write_densities</a> ()</td></tr>
<tr class="memdesc:a81e61269fb96b5478fd7140a1f185ec1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to write neutron and proton densities to files.  <a href="namespaceroutines.html#a81e61269fb96b5478fd7140a1f185ec1">More...</a><br /></td></tr>
<tr class="separator:a81e61269fb96b5478fd7140a1f185ec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a59953c814b7fa48f2c4bf31d1763a2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a4a59953c814b7fa48f2c4bf31d1763a2">routines::write_fields</a> ()</td></tr>
<tr class="memdesc:a4a59953c814b7fa48f2c4bf31d1763a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to write neutron and proton fields to files.  <a href="namespaceroutines.html#a4a59953c814b7fa48f2c4bf31d1763a2">More...</a><br /></td></tr>
<tr class="separator:a4a59953c814b7fa48f2c4bf31d1763a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad51ac6c5da6056a5346d7b15b3fbe7b4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#ad51ac6c5da6056a5346d7b15b3fbe7b4">routines::write_sp_states_p</a> ()</td></tr>
<tr class="memdesc:ad51ac6c5da6056a5346d7b15b3fbe7b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to write proton single particle energies to file, and extra details if BCS has been performed.  <a href="namespaceroutines.html#ad51ac6c5da6056a5346d7b15b3fbe7b4">More...</a><br /></td></tr>
<tr class="separator:ad51ac6c5da6056a5346d7b15b3fbe7b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4433ed4e6fbf0c81f38d8df1749be025"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a4433ed4e6fbf0c81f38d8df1749be025">routines::file_unit_0</a></td></tr>
<tr class="separator:a4433ed4e6fbf0c81f38d8df1749be025"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a806b34a65a0678e540be124100a0f908"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a806b34a65a0678e540be124100a0f908">routines::file_unit_1</a></td></tr>
<tr class="memdesc:a806b34a65a0678e540be124100a0f908"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unit numbers for opening files.  <a href="namespaceroutines.html#a806b34a65a0678e540be124100a0f908">More...</a><br /></td></tr>
<tr class="separator:a806b34a65a0678e540be124100a0f908"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="routines_8f90.html">routines.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
