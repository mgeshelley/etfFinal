<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Extended Thomas-Fermi: routines Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Extended Thomas-Fermi
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespaceroutines.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">routines Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module to hold main routines: densities, energies.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a8146fb4359e556bad19f882b8aabfc4b"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b">str2int</a> (string)</td></tr>
<tr class="separator:a8146fb4359e556bad19f882b8aabfc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d41e4cd4e61ac1463c75055bf784e8b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a0d41e4cd4e61ac1463c75055bf784e8b">allocate_arrays</a> ()</td></tr>
<tr class="memdesc:a0d41e4cd4e61ac1463c75055bf784e8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to allocate arrays for all densities and effective masses, and for their derivatives.  <a href="#a0d41e4cd4e61ac1463c75055bf784e8b">More...</a><br /></td></tr>
<tr class="separator:a0d41e4cd4e61ac1463c75055bf784e8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5caa9b33bdf3c960b6bb3bfa96771181"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a5caa9b33bdf3c960b6bb3bfa96771181">initialise_uniform_mesh</a> ()</td></tr>
<tr class="memdesc:a5caa9b33bdf3c960b6bb3bfa96771181"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate number of mesh points for a uniform grid, allocate array for r, and then populate r with the mesh points.  <a href="#a5caa9b33bdf3c960b6bb3bfa96771181">More...</a><br /></td></tr>
<tr class="separator:a5caa9b33bdf3c960b6bb3bfa96771181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27ad9ac802069004010c9759fecced92"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a27ad9ac802069004010c9759fecced92">deallocate_mesh</a> ()</td></tr>
<tr class="memdesc:a27ad9ac802069004010c9759fecced92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to deallocate array for r.  <a href="#a27ad9ac802069004010c9759fecced92">More...</a><br /></td></tr>
<tr class="separator:a27ad9ac802069004010c9759fecced92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7bc716d30ef4d9ecece5daa22324b77"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#ae7bc716d30ef4d9ecece5daa22324b77">deallocate_arrays</a> ()</td></tr>
<tr class="memdesc:ae7bc716d30ef4d9ecece5daa22324b77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to deallocate arrays for all densities and effective masses, and for their derivatives.  <a href="#ae7bc716d30ef4d9ecece5daa22324b77">More...</a><br /></td></tr>
<tr class="separator:ae7bc716d30ef4d9ecece5daa22324b77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a407a248748ce7c0e2e9e5dce03cc9415"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a407a248748ce7c0e2e9e5dce03cc9415">calc_rho_q</a> (rhoqgas, rhoqliq, rq, aq, gammaq, r)</td></tr>
<tr class="memdesc:a407a248748ce7c0e2e9e5dce03cc9415"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the neutron or proton density at a given radius r, using supplied input parameters.  <a href="#a407a248748ce7c0e2e9e5dce03cc9415">More...</a><br /></td></tr>
<tr class="separator:a407a248748ce7c0e2e9e5dce03cc9415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a701f911aa939448c5bee0589d57369ca"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a701f911aa939448c5bee0589d57369ca">calc_f_q</a> (rhot, rhoq, q, fq)</td></tr>
<tr class="memdesc:a701f911aa939448c5bee0589d57369ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the effective mass ratio <img class="formulaInl" alt="$f_q=\frac{m}{m^*_q}$" src="form_13.png"/> for neutrons or protons, for standard Skyrme or for BSk forces.  <a href="#a701f911aa939448c5bee0589d57369ca">More...</a><br /></td></tr>
<tr class="separator:a701f911aa939448c5bee0589d57369ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c520afea1e9ca6698a0792fbac37e7a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a8c520afea1e9ca6698a0792fbac37e7a">calc_w_q</a> (delrho, delrhoq, Wq)</td></tr>
<tr class="memdesc:a8c520afea1e9ca6698a0792fbac37e7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the spin-orbit field <img class="formulaInl" alt="$\textbf{W}_q$" src="form_14.png"/> for neutrons or protons.  <a href="#a8c520afea1e9ca6698a0792fbac37e7a">More...</a><br /></td></tr>
<tr class="separator:a8c520afea1e9ca6698a0792fbac37e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a421a5d2cca448f46b0dfb9bcdeec1111"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a421a5d2cca448f46b0dfb9bcdeec1111">calc_tau_tf</a> (rhoq, tauTF)</td></tr>
<tr class="memdesc:a421a5d2cca448f46b0dfb9bcdeec1111"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the zeroth-order contribution to the kinetic energy density for neutrons or protons.  <a href="#a421a5d2cca448f46b0dfb9bcdeec1111">More...</a><br /></td></tr>
<tr class="separator:a421a5d2cca448f46b0dfb9bcdeec1111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa80f6938f2b9c661821fa8956f8deef"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#aaa80f6938f2b9c661821fa8956f8deef">calc_tau_2_l</a> (rhoq, delrhoq, del2rhoq, tau2Lq, t2contq)</td></tr>
<tr class="memdesc:aaa80f6938f2b9c661821fa8956f8deef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the local second-order contribution to the kinetic energy density for neutrons or protons.  <a href="#aaa80f6938f2b9c661821fa8956f8deef">More...</a><br /></td></tr>
<tr class="separator:aaa80f6938f2b9c661821fa8956f8deef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72bf2988651a9f3251dfb338ad1a7eca"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a72bf2988651a9f3251dfb338ad1a7eca">calc_tau_2_nl</a> (rhoq, delrhoq, fq, delfq, del2fq, Wq, q, tau2NLq, t2contq)</td></tr>
<tr class="memdesc:a72bf2988651a9f3251dfb338ad1a7eca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the non-local second-order contribution to the kinetic energy density for neutrons or protons.  <a href="#a72bf2988651a9f3251dfb338ad1a7eca">More...</a><br /></td></tr>
<tr class="separator:a72bf2988651a9f3251dfb338ad1a7eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c7e02754e0ae8816b1bfeab92df6bc8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a9c7e02754e0ae8816b1bfeab92df6bc8">calc_tau_4_no_spin</a> (rhoq, d1rhoq, d2rhoq, d3rhoq, d4rhoq, fq, d1fq, d2fq, d3fq, d4fq, tau4nospinq, t4contq)</td></tr>
<tr class="memdesc:a9c7e02754e0ae8816b1bfeab92df6bc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the fourth-order contributions to the kinetic energy density (without spin-orbit contributions) <img class="formulaInl" alt="$\textbf{tau}_q$" src="form_15.png"/> for neutrons or protons.  <a href="#a9c7e02754e0ae8816b1bfeab92df6bc8">More...</a><br /></td></tr>
<tr class="separator:a9c7e02754e0ae8816b1bfeab92df6bc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8825f02bb2ac98507fff5024d9b54c8f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a8825f02bb2ac98507fff5024d9b54c8f">calc_tau_4_so</a> (rhoq, d1rhoq, fq, d1fq, d2fq, d1Aq, d2Aq, d3Aq, q, tau_4_so_q, t4contq)</td></tr>
<tr class="memdesc:a8825f02bb2ac98507fff5024d9b54c8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the fourth-order contributions to the kinetic energy density (spin-orbit contributions) <img class="formulaInl" alt="$\textbf{tau}_q$" src="form_15.png"/> for neutrons or protons.  <a href="#a8825f02bb2ac98507fff5024d9b54c8f">More...</a><br /></td></tr>
<tr class="separator:a8825f02bb2ac98507fff5024d9b54c8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af03f37f9deca52ef9a56287f50b982a1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#af03f37f9deca52ef9a56287f50b982a1">calc_j_2_q</a> (rhoq, Wq, fq, q, J2q)</td></tr>
<tr class="memdesc:af03f37f9deca52ef9a56287f50b982a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the second-order contributions to the spin current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons.  <a href="#af03f37f9deca52ef9a56287f50b982a1">More...</a><br /></td></tr>
<tr class="separator:af03f37f9deca52ef9a56287f50b982a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a014fed5fe5fbc19302e7cbc651ba59bd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a014fed5fe5fbc19302e7cbc651ba59bd">calc_j_4_q</a> (rhoq, d1rhoq, fq, d1fq, d2fq, d1Aq, d2Aq, d3Aq, q, J4q)</td></tr>
<tr class="memdesc:a014fed5fe5fbc19302e7cbc651ba59bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the fourth-order contributions to the spin current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons.  <a href="#a014fed5fe5fbc19302e7cbc651ba59bd">More...</a><br /></td></tr>
<tr class="separator:a014fed5fe5fbc19302e7cbc651ba59bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a136b7a1f0387466390decb98ce91c152"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a136b7a1f0387466390decb98ce91c152">calc_div_j_2_q</a> (rhoq, d1rhoq, fq, d1fq, d1Aq, d2Aq, q, divJ2q)</td></tr>
<tr class="memdesc:a136b7a1f0387466390decb98ce91c152"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the second-order contributions to the divergence of the current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons.  <a href="#a136b7a1f0387466390decb98ce91c152">More...</a><br /></td></tr>
<tr class="separator:a136b7a1f0387466390decb98ce91c152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f66729f05be35eda4266dbf47eda026"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a7f66729f05be35eda4266dbf47eda026">calc_div_j_4_q</a> (rhoq, d1rhoq, d2rhoq, fq, d1fq, d2fq, d3fq, d1Aq, d2Aq, d3Aq, d4Aq, q, divJ4q)</td></tr>
<tr class="memdesc:a7f66729f05be35eda4266dbf47eda026"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the fourth-order contributions to the divergence of the current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons.  <a href="#a7f66729f05be35eda4266dbf47eda026">More...</a><br /></td></tr>
<tr class="separator:a7f66729f05be35eda4266dbf47eda026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a44c591985c939162dabdeab4a4ced8"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a2a44c591985c939162dabdeab4a4ced8">calc_u_q</a> (rhot, rhon, rhop, delrhot, delrhon, delrhop, del2rhot, del2rhon, del2rhop, taut, taun, taup, divJt, divJq, q)</td></tr>
<tr class="memdesc:a2a44c591985c939162dabdeab4a4ced8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the central potential <img class="formulaInl" alt="$U_q$" src="form_18.png"/> for neutrons or protons, for standard Skyrme or for BSk forces with extra terms.  <a href="#a2a44c591985c939162dabdeab4a4ced8">More...</a><br /></td></tr>
<tr class="separator:a2a44c591985c939162dabdeab4a4ced8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa995449a9eb9c404dbd756bdbea180a2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2">eval_fields</a> ()</td></tr>
<tr class="memdesc:aa995449a9eb9c404dbd756bdbea180a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives), spin-orbit fields, spin current densities (and derivatives)  <a href="#aa995449a9eb9c404dbd756bdbea180a2">More...</a><br /></td></tr>
<tr class="separator:aa995449a9eb9c404dbd756bdbea180a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97bfcff7e603cf9df3dcd48ae21b4612"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612">eval_tau_etf</a> ()</td></tr>
<tr class="memdesc:a97bfcff7e603cf9df3dcd48ae21b4612"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the kinetic energy density <img class="formulaInl" alt="$\tau_{ETF}$" src="form_19.png"/> with the (extended) Thomas-Fermi approximation at order specified by "etf_order".  <a href="#a97bfcff7e603cf9df3dcd48ae21b4612">More...</a><br /></td></tr>
<tr class="separator:a97bfcff7e603cf9df3dcd48ae21b4612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb83677ec76758dadc35de4b01bac45c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#afb83677ec76758dadc35de4b01bac45c">charge</a> (rho, Neutr, Nprot, Ngrid1, del1, rhoch)</td></tr>
<tr class="memdesc:afb83677ec76758dadc35de4b01bac45c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the charge density from the matter densities. Modified by M. Shelley.  <a href="#afb83677ec76758dadc35de4b01bac45c">More...</a><br /></td></tr>
<tr class="separator:afb83677ec76758dadc35de4b01bac45c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74ed186c93b400a14428192e1cb7a0b2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a74ed186c93b400a14428192e1cb7a0b2">eval_coulomb</a> (prot_dens, calc_exchange)</td></tr>
<tr class="memdesc:a74ed186c93b400a14428192e1cb7a0b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the Coulomb potentials and energy densities, using either the proton or charge density.  <a href="#a74ed186c93b400a14428192e1cb7a0b2">More...</a><br /></td></tr>
<tr class="separator:a74ed186c93b400a14428192e1cb7a0b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b55cc503c7168299be63556e2602bd0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a0b55cc503c7168299be63556e2602bd0">eval_electrons</a> ()</td></tr>
<tr class="memdesc:a0b55cc503c7168299be63556e2602bd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the proton-electron potential which contributes to <img class="formulaInl" alt="$U_q$" src="form_18.png"/>, all energy contributions, and the pressure, coming from a homogeneous electron gas. Also calculates the electron chemical potential.  <a href="#a0b55cc503c7168299be63556e2602bd0">More...</a><br /></td></tr>
<tr class="separator:a0b55cc503c7168299be63556e2602bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ee5e5cd7ce81b013d18b19f5f9a4092"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a6ee5e5cd7ce81b013d18b19f5f9a4092">eval_u_q</a> ()</td></tr>
<tr class="memdesc:a6ee5e5cd7ce81b013d18b19f5f9a4092"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the central fields <img class="formulaInl" alt="$U_q$" src="form_18.png"/>.  <a href="#a6ee5e5cd7ce81b013d18b19f5f9a4092">More...</a><br /></td></tr>
<tr class="separator:a6ee5e5cd7ce81b013d18b19f5f9a4092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae210968d134fbcc79297971cc4fefb82"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#ae210968d134fbcc79297971cc4fefb82">eval_skyrme_energy_density</a> ()</td></tr>
<tr class="memdesc:ae210968d134fbcc79297971cc4fefb82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the Skyrme energy density, after first separately evaluating the field energy density.  <a href="#ae210968d134fbcc79297971cc4fefb82">More...</a><br /></td></tr>
<tr class="separator:ae210968d134fbcc79297971cc4fefb82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a383e2bf5a1fa37fbf95dd5f6ddbcc6be"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a383e2bf5a1fa37fbf95dd5f6ddbcc6be">pressure</a> ()</td></tr>
<tr class="memdesc:a383e2bf5a1fa37fbf95dd5f6ddbcc6be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the nuclear contribution to the pressure, and then the total pressure.  <a href="#a383e2bf5a1fa37fbf95dd5f6ddbcc6be">More...</a><br /></td></tr>
<tr class="separator:a383e2bf5a1fa37fbf95dd5f6ddbcc6be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8346e8e5457d6befb48b0ac56f4fdf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a0b8346e8e5457d6befb48b0ac56f4fdf">calc_particle_number</a> ()</td></tr>
<tr class="memdesc:a0b8346e8e5457d6befb48b0ac56f4fdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the number of particles in the Wigner-Seitz cell.  <a href="#a0b8346e8e5457d6befb48b0ac56f4fdf">More...</a><br /></td></tr>
<tr class="separator:a0b8346e8e5457d6befb48b0ac56f4fdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93de76f3b26ead66893f46dc4892dbcb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb">eval_ws_quantities</a> ()</td></tr>
<tr class="memdesc:a93de76f3b26ead66893f46dc4892dbcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in the WS cell with densities <img class="formulaInl" alt="$rho_q$" src="form_20.png"/>.  <a href="#a93de76f3b26ead66893f46dc4892dbcb">More...</a><br /></td></tr>
<tr class="separator:a93de76f3b26ead66893f46dc4892dbcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f2a013c7bb06da429f995e288515248"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a8f2a013c7bb06da429f995e288515248">calc_e_f_q</a> (rhoq, fq, q)</td></tr>
<tr class="memdesc:a8f2a013c7bb06da429f995e288515248"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate the Fermi energy at a given density and effective mass, for neutrons or protons.  <a href="#a8f2a013c7bb06da429f995e288515248">More...</a><br /></td></tr>
<tr class="separator:a8f2a013c7bb06da429f995e288515248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e52c281532c938dfa10d85404a367a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a92e52c281532c938dfa10d85404a367a">d1</a> (n, h, f, df)</td></tr>
<tr class="memdesc:a92e52c281532c938dfa10d85404a367a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes the first derivative of function evaluated on the meshpoints 1,...,npt. The input is the function f with extrapolated values in -1, 0. Modified by M. Shelley.  <a href="#a92e52c281532c938dfa10d85404a367a">More...</a><br /></td></tr>
<tr class="separator:a92e52c281532c938dfa10d85404a367a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc8447e9af12216ae995f63c1606f1a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#aafc8447e9af12216ae995f63c1606f1a">d2</a> (n, h, f, d2f)</td></tr>
<tr class="memdesc:aafc8447e9af12216ae995f63c1606f1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes the second derivative of function evaluated on the meshpoints 1,...,npt. The input is the function f with extrapolated values in -1, 0. Modified by M. Shelley.  <a href="#aafc8447e9af12216ae995f63c1606f1a">More...</a><br /></td></tr>
<tr class="separator:aafc8447e9af12216ae995f63c1606f1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a635a2461a6c20207dd3b268842381ce3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a635a2461a6c20207dd3b268842381ce3">lap_sphe_symm</a> (f, df_dr, d2f_dr2)</td></tr>
<tr class="memdesc:a635a2461a6c20207dd3b268842381ce3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to carry out Laplacian in spherical symmetry.  <a href="#a635a2461a6c20207dd3b268842381ce3">More...</a><br /></td></tr>
<tr class="separator:a635a2461a6c20207dd3b268842381ce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac563b00969cb307d71ebc02aaef0a3b4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#ac563b00969cb307d71ebc02aaef0a3b4">d3</a> (f, d3f_dr3)</td></tr>
<tr class="memdesc:ac563b00969cb307d71ebc02aaef0a3b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate third derivative of function f evaluated on evenly-spaced meshpoints from 1 to n. Works with extrapolated values in -2,-1,0. Uses 7-point stencil.  <a href="#ac563b00969cb307d71ebc02aaef0a3b4">More...</a><br /></td></tr>
<tr class="separator:ac563b00969cb307d71ebc02aaef0a3b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d38e9b19f2e939feb7840d2575fbb56"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a6d38e9b19f2e939feb7840d2575fbb56">d4</a> (f, d4f_dr4)</td></tr>
<tr class="memdesc:a6d38e9b19f2e939feb7840d2575fbb56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate fourth derivative of function f evaluated on evenly-spaced meshpoints from 1 to n. Works with extrapolated values in -2,-1,0. Uses 7-point stencil.  <a href="#a6d38e9b19f2e939feb7840d2575fbb56">More...</a><br /></td></tr>
<tr class="separator:a6d38e9b19f2e939feb7840d2575fbb56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af143340288720f8019e944ec7110a84e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#af143340288720f8019e944ec7110a84e">extrapolate_back_3</a> (grid)</td></tr>
<tr class="memdesc:af143340288720f8019e944ec7110a84e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to extrapolate back 3 points on the r mesh, to faciliate the calculation of first and second derivatives using a 5-point stencil. Values in grid start at 4, extrapolated values are put in elements 3,2,1. Coefficients come from solving 4th-order polynomial, assuming that f'(0) = 0, and f(-h) = f(h).  <a href="#af143340288720f8019e944ec7110a84e">More...</a><br /></td></tr>
<tr class="separator:af143340288720f8019e944ec7110a84e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5737b4327dcaa959a9ee519e4fca42e8"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8">ws_integral</a> (quantity, n_max)</td></tr>
<tr class="memdesc:a5737b4327dcaa959a9ee519e4fca42e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to integrate a density or field over the whole W-S cell, using Simpson's rule (+ Simpson's 3/8 rule if odd number of points)  <a href="#a5737b4327dcaa959a9ee519e4fca42e8">More...</a><br /></td></tr>
<tr class="separator:a5737b4327dcaa959a9ee519e4fca42e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81e61269fb96b5478fd7140a1f185ec1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a81e61269fb96b5478fd7140a1f185ec1">write_densities</a> ()</td></tr>
<tr class="memdesc:a81e61269fb96b5478fd7140a1f185ec1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to write neutron and proton densities to files.  <a href="#a81e61269fb96b5478fd7140a1f185ec1">More...</a><br /></td></tr>
<tr class="separator:a81e61269fb96b5478fd7140a1f185ec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a59953c814b7fa48f2c4bf31d1763a2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a4a59953c814b7fa48f2c4bf31d1763a2">write_fields</a> ()</td></tr>
<tr class="memdesc:a4a59953c814b7fa48f2c4bf31d1763a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to write neutron and proton fields to files.  <a href="#a4a59953c814b7fa48f2c4bf31d1763a2">More...</a><br /></td></tr>
<tr class="separator:a4a59953c814b7fa48f2c4bf31d1763a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad51ac6c5da6056a5346d7b15b3fbe7b4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#ad51ac6c5da6056a5346d7b15b3fbe7b4">write_sp_states_p</a> ()</td></tr>
<tr class="memdesc:ad51ac6c5da6056a5346d7b15b3fbe7b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to write proton single particle energies to file, and extra details if BCS has been performed.  <a href="#ad51ac6c5da6056a5346d7b15b3fbe7b4">More...</a><br /></td></tr>
<tr class="separator:ad51ac6c5da6056a5346d7b15b3fbe7b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4433ed4e6fbf0c81f38d8df1749be025"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a4433ed4e6fbf0c81f38d8df1749be025">file_unit_0</a></td></tr>
<tr class="separator:a4433ed4e6fbf0c81f38d8df1749be025"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a806b34a65a0678e540be124100a0f908"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroutines.html#a806b34a65a0678e540be124100a0f908">file_unit_1</a></td></tr>
<tr class="memdesc:a806b34a65a0678e540be124100a0f908"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unit numbers for opening files.  <a href="#a806b34a65a0678e540be124100a0f908">More...</a><br /></td></tr>
<tr class="separator:a806b34a65a0678e540be124100a0f908"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p class="">Module to hold main routines: densities, energies. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a0d41e4cd4e61ac1463c75055bf784e8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d41e4cd4e61ac1463c75055bf784e8b">&#9670;&nbsp;</a></span>allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::allocate_arrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to allocate arrays for all densities and effective masses, and for their derivatives. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a0d41e4cd4e61ac1463c75055bf784e8b_icgraph.png" border="0" usemap="#namespaceroutines_a0d41e4cd4e61ac1463c75055bf784e8b_icgraph" alt=""/></div>
<map name="namespaceroutines_a0d41e4cd4e61ac1463c75055bf784e8b_icgraph" id="namespaceroutines_a0d41e4cd4e61ac1463c75055bf784e8b_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="175,13,213,39"/>
</map>
</div>

</div>
</div>
<a id="a136b7a1f0387466390decb98ce91c152"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a136b7a1f0387466390decb98ce91c152">&#9670;&nbsp;</a></span>calc_div_j_2_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_div_j_2_q </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d2Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>divJ2q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the second-order contributions to the divergence of the current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1rhoq</td><td>First derivative of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fq</td><td>Effective mass for protons or neutrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1fq</td><td>First derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1Aq</td><td>First derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d2Aq</td><td>Second derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Isospin </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">divJ2q</td><td>Array for second-order contributions </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a136b7a1f0387466390decb98ce91c152_icgraph.png" border="0" usemap="#namespaceroutines_a136b7a1f0387466390decb98ce91c152_icgraph" alt=""/></div>
<map name="namespaceroutines_a136b7a1f0387466390decb98ce91c152_icgraph" id="namespaceroutines_a136b7a1f0387466390decb98ce91c152_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="177,13,316,39"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="841,13,880,39"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="364,38,551,65"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="599,38,793,65"/>
</map>
</div>

</div>
</div>
<a id="a7f66729f05be35eda4266dbf47eda026"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f66729f05be35eda4266dbf47eda026">&#9670;&nbsp;</a></span>calc_div_j_4_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_div_j_4_q </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d2rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d2fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d3fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d2Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d3Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d4Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>divJ4q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the fourth-order contributions to the divergence of the current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1rhoq</td><td>First derivative of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d2rhoq</td><td>Second derivative of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fq</td><td>Effective mass for protons or neutrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1fq</td><td>First derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d2fq</td><td>Second derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d3fq</td><td>Third derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1Aq</td><td>First derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d2Aq</td><td>Second derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d3Aq</td><td>Third derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d4Aq</td><td>Fourth derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Isospin </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">divJ4q</td><td>Array for fourth-order contributions </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a7f66729f05be35eda4266dbf47eda026_icgraph.png" border="0" usemap="#namespaceroutines_a7f66729f05be35eda4266dbf47eda026_icgraph" alt=""/></div>
<map name="namespaceroutines_a7f66729f05be35eda4266dbf47eda026_icgraph" id="namespaceroutines_a7f66729f05be35eda4266dbf47eda026_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="177,13,316,39"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="841,13,880,39"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="364,38,551,65"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="599,38,793,65"/>
</map>
</div>

</div>
</div>
<a id="a8f2a013c7bb06da429f995e288515248"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f2a013c7bb06da429f995e288515248">&#9670;&nbsp;</a></span>calc_e_f_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function routines::calc_e_f_q </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to evaluate the Fermi energy at a given density and effective mass, for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fn</td><td>Neutron or proton effective mass </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a8f2a013c7bb06da429f995e288515248_icgraph.png" border="0" usemap="#namespaceroutines_a8f2a013c7bb06da429f995e288515248_icgraph" alt=""/></div>
<map name="namespaceroutines_a8f2a013c7bb06da429f995e288515248_icgraph" id="namespaceroutines_a8f2a013c7bb06da429f995e288515248_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="375,5,569,32"/>
<area shape="rect" id="node4" href="namespacepairing.html#ac34989a934af1e6a63131c619426c5aa" title="Subroutine to calculate the pairing energy for the WS cell, using the method specified in &quot;input..." alt="" coords="192,31,327,57"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="617,5,656,32"/>
</map>
</div>

</div>
</div>
<a id="a701f911aa939448c5bee0589d57369ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a701f911aa939448c5bee0589d57369ca">&#9670;&nbsp;</a></span>calc_f_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_f_q </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>rhot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>fq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the effective mass ratio <img class="formulaInl" alt="$f_q=\frac{m}{m^*_q}$" src="form_13.png"/> for neutrons or protons, for standard Skyrme or for BSk forces. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhot</td><td>Total density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Isospin </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fq</td><td>Neutron or proton effective mass </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a701f911aa939448c5bee0589d57369ca_cgraph.png" border="0" usemap="#namespaceroutines_a701f911aa939448c5bee0589d57369ca_cgraph" alt=""/></div>
<map name="namespaceroutines_a701f911aa939448c5bee0589d57369ca_cgraph" id="namespaceroutines_a701f911aa939448c5bee0589d57369ca_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b" title="routines::str2int" alt="" coords="179,5,291,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a701f911aa939448c5bee0589d57369ca_icgraph.png" border="0" usemap="#namespaceroutines_a701f911aa939448c5bee0589d57369ca_icgraph" alt=""/></div>
<map name="namespaceroutines_a701f911aa939448c5bee0589d57369ca_icgraph" id="namespaceroutines_a701f911aa939448c5bee0589d57369ca_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="179,5,317,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="843,5,881,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="365,31,552,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="600,31,795,57"/>
</map>
</div>

</div>
</div>
<a id="af03f37f9deca52ef9a56287f50b982a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af03f37f9deca52ef9a56287f50b982a1">&#9670;&nbsp;</a></span>calc_j_2_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_j_2_q </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>Wq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>J2q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the second-order contributions to the spin current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Wq</td><td>Spin-orbit field </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fq</td><td>Effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Isospin [in,out] J2q Array for second-order contributions </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_af03f37f9deca52ef9a56287f50b982a1_icgraph.png" border="0" usemap="#namespaceroutines_af03f37f9deca52ef9a56287f50b982a1_icgraph" alt=""/></div>
<map name="namespaceroutines_af03f37f9deca52ef9a56287f50b982a1_icgraph" id="namespaceroutines_af03f37f9deca52ef9a56287f50b982a1_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="192,5,331,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="856,5,895,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="379,31,565,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="613,31,808,57"/>
</map>
</div>

</div>
</div>
<a id="a014fed5fe5fbc19302e7cbc651ba59bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a014fed5fe5fbc19302e7cbc651ba59bd">&#9670;&nbsp;</a></span>calc_j_4_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_j_4_q </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d2fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d2Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d3Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>J4q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the fourth-order contributions to the spin current density <img class="formulaInl" alt="$\textbf{J}_q$" src="form_17.png"/> for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1rhoq</td><td>First derivative of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fq</td><td>Effective mass for protons or neutrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1fq</td><td>First derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d2fq</td><td>Second derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1Aq</td><td>First derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d2Aq</td><td>Second derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d3Aq</td><td>Third derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Isospin </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">J4q</td><td>Array for fourth-order contributions </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a014fed5fe5fbc19302e7cbc651ba59bd_icgraph.png" border="0" usemap="#namespaceroutines_a014fed5fe5fbc19302e7cbc651ba59bd_icgraph" alt=""/></div>
<map name="namespaceroutines_a014fed5fe5fbc19302e7cbc651ba59bd_icgraph" id="namespaceroutines_a014fed5fe5fbc19302e7cbc651ba59bd_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="192,5,331,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="856,5,895,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="379,31,565,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="613,31,808,57"/>
</map>
</div>

</div>
</div>
<a id="a0b8346e8e5457d6befb48b0ac56f4fdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b8346e8e5457d6befb48b0ac56f4fdf">&#9670;&nbsp;</a></span>calc_particle_number()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_particle_number </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the number of particles in the Wigner-Seitz cell. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a0b8346e8e5457d6befb48b0ac56f4fdf_cgraph.png" border="0" usemap="#namespaceroutines_a0b8346e8e5457d6befb48b0ac56f4fdf_cgraph" alt=""/></div>
<map name="namespaceroutines_a0b8346e8e5457d6befb48b0ac56f4fdf_cgraph" id="namespaceroutines_a0b8346e8e5457d6befb48b0ac56f4fdf_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8" title="Function to integrate a density or field over the whole W&#45;S cell, using Simpson&#39;s rule (+ Simpson&#39;s 3..." alt="" coords="203,13,345,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a0b8346e8e5457d6befb48b0ac56f4fdf_icgraph.png" border="0" usemap="#namespaceroutines_a0b8346e8e5457d6befb48b0ac56f4fdf_icgraph" alt=""/></div>
<map name="namespaceroutines_a0b8346e8e5457d6befb48b0ac56f4fdf_icgraph" id="namespaceroutines_a0b8346e8e5457d6befb48b0ac56f4fdf_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="680,13,719,39"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="203,38,389,65"/>
<area shape="rect" id="node4" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="437,38,632,65"/>
</map>
</div>

</div>
</div>
<a id="a407a248748ce7c0e2e9e5dce03cc9415"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a407a248748ce7c0e2e9e5dce03cc9415">&#9670;&nbsp;</a></span>calc_rho_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function routines::calc_rho_q </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>rhoqgas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>rhoqliq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>rq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>gammaq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate the neutron or proton density at a given radius r, using supplied input parameters. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoqgas</td><td>Asymptotic density in gas far from surface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoqliq</td><td>Asymptotic density in cluster far from surface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rq</td><td>Cluster radius </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aq</td><td>Surface diffuseness </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gammaq</td><td>Parameter allowing for "asymmetric surface" </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Radius </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a407a248748ce7c0e2e9e5dce03cc9415_icgraph.png" border="0" usemap="#namespaceroutines_a407a248748ce7c0e2e9e5dce03cc9415_icgraph" alt=""/></div>
<map name="namespaceroutines_a407a248748ce7c0e2e9e5dce03cc9415_icgraph" id="namespaceroutines_a407a248748ce7c0e2e9e5dce03cc9415_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="192,5,379,32"/>
<area shape="rect" id="node5" href="namespacetest.html#ac81b1d59a968470b8ef8a165101df52c" title="Subroutine to calculate the density profiles using sample parameters. " alt="" coords="457,56,591,83"/>
<area shape="rect" id="node3" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="427,5,621,32"/>
<area shape="rect" id="node4" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="669,31,708,57"/>
</map>
</div>

</div>
</div>
<a id="aaa80f6938f2b9c661821fa8956f8deef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa80f6938f2b9c661821fa8956f8deef">&#9670;&nbsp;</a></span>calc_tau_2_l()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_tau_2_l </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>delrhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>del2rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>tau2Lq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>t2contq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate the local second-order contribution to the kinetic energy density for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delrhoq</td><td>Gradient of proton or neutron density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">del2rhoq</td><td>Laplacian of proton or neutron density </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tau2Lq</td><td>Array for local second-order contributions </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t2contq</td><td>Array for individual second-order contributions </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_aaa80f6938f2b9c661821fa8956f8deef_icgraph.png" border="0" usemap="#namespaceroutines_aaa80f6938f2b9c661821fa8956f8deef_icgraph" alt=""/></div>
<map name="namespaceroutines_aaa80f6938f2b9c661821fa8956f8deef_icgraph" id="namespaceroutines_aaa80f6938f2b9c661821fa8956f8deef_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612" title="Subroutine to calculate the kinetic energy density &#160;with the (extended) Thomas&#45;Fermi approximation at..." alt="" coords="203,5,349,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="875,5,913,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="397,31,584,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="632,31,827,57"/>
</map>
</div>

</div>
</div>
<a id="a72bf2988651a9f3251dfb338ad1a7eca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72bf2988651a9f3251dfb338ad1a7eca">&#9670;&nbsp;</a></span>calc_tau_2_nl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_tau_2_nl </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>delrhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>delfq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>del2fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>Wq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>tau2NLq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n,2:4), intent(inout)&#160;</td>
          <td class="paramname"><em>t2contq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the non-local second-order contribution to the kinetic energy density for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delrhoq</td><td>Gradient of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fq</td><td>Effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delfq</td><td>Gradient of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">del2fq</td><td>Laplacian of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Wq</td><td>Spin-orbit field </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Isospin </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tau2NLq</td><td>Array for non-local second-order contributions </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t2contq</td><td>Array for individual second-order contributions </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a72bf2988651a9f3251dfb338ad1a7eca_icgraph.png" border="0" usemap="#namespaceroutines_a72bf2988651a9f3251dfb338ad1a7eca_icgraph" alt=""/></div>
<map name="namespaceroutines_a72bf2988651a9f3251dfb338ad1a7eca_icgraph" id="namespaceroutines_a72bf2988651a9f3251dfb338ad1a7eca_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612" title="Subroutine to calculate the kinetic energy density &#160;with the (extended) Thomas&#45;Fermi approximation at..." alt="" coords="209,5,356,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="881,5,920,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="404,31,591,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="639,31,833,57"/>
</map>
</div>

</div>
</div>
<a id="a9c7e02754e0ae8816b1bfeab92df6bc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c7e02754e0ae8816b1bfeab92df6bc8">&#9670;&nbsp;</a></span>calc_tau_4_no_spin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_tau_4_no_spin </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d2rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d3rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d4rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d2fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d3fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d4fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>tau4nospinq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n,1:3), intent(inout)&#160;</td>
          <td class="paramname"><em>t4contq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the fourth-order contributions to the kinetic energy density (without spin-orbit contributions) <img class="formulaInl" alt="$\textbf{tau}_q$" src="form_15.png"/> for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1rhoq</td><td>First derivative of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d2rhoq</td><td>Second derivative of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d3rhoq</td><td>Third derivative of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d4rhoq</td><td>Fourth derivative of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fq</td><td>Effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1fq</td><td>First derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d2fq</td><td>Second derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d3fq</td><td>Third derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d4fq</td><td>Fourth derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tau4nospinq</td><td>Array for fourth-order contributions (no spin-orbit) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t4contq</td><td>Array for individual fourth-order contributions </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a9c7e02754e0ae8816b1bfeab92df6bc8_icgraph.png" border="0" usemap="#namespaceroutines_a9c7e02754e0ae8816b1bfeab92df6bc8_icgraph" alt=""/></div>
<map name="namespaceroutines_a9c7e02754e0ae8816b1bfeab92df6bc8_icgraph" id="namespaceroutines_a9c7e02754e0ae8816b1bfeab92df6bc8_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612" title="Subroutine to calculate the kinetic energy density &#160;with the (extended) Thomas&#45;Fermi approximation at..." alt="" coords="179,13,325,39"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="851,13,889,39"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="373,38,560,65"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="608,38,803,65"/>
</map>
</div>

</div>
</div>
<a id="a8825f02bb2ac98507fff5024d9b54c8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8825f02bb2ac98507fff5024d9b54c8f">&#9670;&nbsp;</a></span>calc_tau_4_so()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_tau_4_so </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d2fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d1Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d2Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>d3Aq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>tau_4_so_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>t4contq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the fourth-order contributions to the kinetic energy density (spin-orbit contributions) <img class="formulaInl" alt="$\textbf{tau}_q$" src="form_15.png"/> for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1rhoq</td><td>First derivative of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fq</td><td>Effective mass for protons or neutrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1fq</td><td>First derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d2fq</td><td>Second derivative of effective mass for neutrons or protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d1Aq</td><td>First derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d2Aq</td><td>Second derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d3Aq</td><td>Third derivative of "composite" neutron or proton density <img class="formulaInl" alt="$A_q$" src="form_16.png"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Isospin </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tau_4_so_q</td><td>Array for fourth-order contributions (spin- orbit) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t4contq</td><td>Array for individual fourth-order contributions </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a8825f02bb2ac98507fff5024d9b54c8f_icgraph.png" border="0" usemap="#namespaceroutines_a8825f02bb2ac98507fff5024d9b54c8f_icgraph" alt=""/></div>
<map name="namespaceroutines_a8825f02bb2ac98507fff5024d9b54c8f_icgraph" id="namespaceroutines_a8825f02bb2ac98507fff5024d9b54c8f_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612" title="Subroutine to calculate the kinetic energy density &#160;with the (extended) Thomas&#45;Fermi approximation at..." alt="" coords="213,5,360,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="885,5,924,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="408,31,595,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="643,31,837,57"/>
</map>
</div>

</div>
</div>
<a id="a421a5d2cca448f46b0dfb9bcdeec1111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a421a5d2cca448f46b0dfb9bcdeec1111">&#9670;&nbsp;</a></span>calc_tau_tf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_tau_tf </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>rhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>tauTF</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate the zeroth-order contribution to the kinetic energy density for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoq</td><td>Neutron or proton density </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tauTF</td><td>Array for zeroth-order contributions </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a421a5d2cca448f46b0dfb9bcdeec1111_icgraph.png" border="0" usemap="#namespaceroutines_a421a5d2cca448f46b0dfb9bcdeec1111_icgraph" alt=""/></div>
<map name="namespaceroutines_a421a5d2cca448f46b0dfb9bcdeec1111_icgraph" id="namespaceroutines_a421a5d2cca448f46b0dfb9bcdeec1111_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612" title="Subroutine to calculate the kinetic energy density &#160;with the (extended) Thomas&#45;Fermi approximation at..." alt="" coords="193,5,340,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="865,5,904,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="388,31,575,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="623,31,817,57"/>
</map>
</div>

</div>
</div>
<a id="a2a44c591985c939162dabdeab4a4ced8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a44c591985c939162dabdeab4a4ced8">&#9670;&nbsp;</a></span>calc_u_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function routines::calc_u_q </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>rhot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>rhon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>rhop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>delrhot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>delrhon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>delrhop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>del2rhot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>del2rhon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>del2rhop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>taut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>taun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>taup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>divJt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>divJq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate the central potential <img class="formulaInl" alt="$U_q$" src="form_18.png"/> for neutrons or protons, for standard Skyrme or for BSk forces with extra terms. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rhot</td><td>Total density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhon</td><td>Neutron density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhop</td><td>Proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delrhot</td><td>First derivative of total density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delrhon</td><td>First derivative of neutron density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delrhop</td><td>First derivative of proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">del2rhot</td><td>Laplacian of total density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">del2rhon</td><td>Laplacian of neutron density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">del2rhop</td><td>Laplacian of proton density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">taut</td><td>Total kinetic density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">taun</td><td>Neutron kinetic density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">taup</td><td>Proton kinetic density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">divJt</td><td>Divergence of total spin current density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">divJq</td><td>Divergence of proton or neutron spin current density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Isospin </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a2a44c591985c939162dabdeab4a4ced8_cgraph.png" border="0" usemap="#namespaceroutines_a2a44c591985c939162dabdeab4a4ced8_cgraph" alt=""/></div>
<map name="namespaceroutines_a2a44c591985c939162dabdeab4a4ced8_cgraph" id="namespaceroutines_a2a44c591985c939162dabdeab4a4ced8_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b" title="routines::str2int" alt="" coords="181,5,293,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a2a44c591985c939162dabdeab4a4ced8_icgraph.png" border="0" usemap="#namespaceroutines_a2a44c591985c939162dabdeab4a4ced8_icgraph" alt=""/></div>
<map name="namespaceroutines_a2a44c591985c939162dabdeab4a4ced8_icgraph" id="namespaceroutines_a2a44c591985c939162dabdeab4a4ced8_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a6ee5e5cd7ce81b013d18b19f5f9a4092" title="Subroutine to evaluate the central fields . " alt="" coords="181,5,309,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="835,5,873,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="357,31,544,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="592,31,787,57"/>
</map>
</div>

</div>
</div>
<a id="a8c520afea1e9ca6698a0792fbac37e7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c520afea1e9ca6698a0792fbac37e7a">&#9670;&nbsp;</a></span>calc_w_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::calc_w_q </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>delrho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>delrhoq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>Wq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate the spin-orbit field <img class="formulaInl" alt="$\textbf{W}_q$" src="form_14.png"/> for neutrons or protons. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">delrho</td><td>Gradient of total density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delrhoq</td><td>Gradient of neutron or proton density </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Wq</td><td>Array for spin-orbit field </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a8c520afea1e9ca6698a0792fbac37e7a_icgraph.png" border="0" usemap="#namespaceroutines_a8c520afea1e9ca6698a0792fbac37e7a_icgraph" alt=""/></div>
<map name="namespaceroutines_a8c520afea1e9ca6698a0792fbac37e7a_icgraph" id="namespaceroutines_a8c520afea1e9ca6698a0792fbac37e7a_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="184,5,323,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="848,5,887,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="371,31,557,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="605,31,800,57"/>
</map>
</div>

</div>
</div>
<a id="afb83677ec76758dadc35de4b01bac45c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb83677ec76758dadc35de4b01bac45c">&#9670;&nbsp;</a></span>charge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::charge </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(ngrid1,0:1), intent(in)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>Neutr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>Nprot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Ngrid1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>del1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(ngrid1), intent(inout)&#160;</td>
          <td class="paramname"><em>rhoch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the charge density from the matter densities. Modified by M. Shelley. </p>
<dl class="section author"><dt>Author</dt><dd>A. Pastore, M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rho</td><td>Neutron and proton densities </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Neutr</td><td>Number of neutrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nprot</td><td>Number of protons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Ngrid1</td><td>Number of mesh points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">del1</td><td>Step size </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rhoch</td><td>Array for charge density </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_afb83677ec76758dadc35de4b01bac45c_icgraph.png" border="0" usemap="#namespaceroutines_afb83677ec76758dadc35de4b01bac45c_icgraph" alt=""/></div>
<map name="namespaceroutines_afb83677ec76758dadc35de4b01bac45c_icgraph" id="namespaceroutines_afb83677ec76758dadc35de4b01bac45c_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="168,5,355,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="403,5,597,32"/>
<area shape="rect" id="node4" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="645,5,684,32"/>
</map>
</div>

</div>
</div>
<a id="a92e52c281532c938dfa10d85404a367a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92e52c281532c938dfa10d85404a367a">&#9670;&nbsp;</a></span>d1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::d1 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(-1:n), intent(in)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>df</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine computes the first derivative of function evaluated on the meshpoints 1,...,npt. The input is the function f with extrapolated values in -1, 0. Modified by M. Shelley. </p>
<dl class="section author"><dt>Author</dt><dd>A. Pastore, M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of meshpoints </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Input function (1:n) with extrapolated values in -1,0 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Step size </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">df</td><td>Array for first derivatives </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a92e52c281532c938dfa10d85404a367a_icgraph.png" border="0" usemap="#namespaceroutines_a92e52c281532c938dfa10d85404a367a_icgraph" alt=""/></div>
<map name="namespaceroutines_a92e52c281532c938dfa10d85404a367a_icgraph" id="namespaceroutines_a92e52c281532c938dfa10d85404a367a_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="144,5,283,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="808,5,847,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="331,31,517,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="565,31,760,57"/>
</map>
</div>

</div>
</div>
<a id="aafc8447e9af12216ae995f63c1606f1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafc8447e9af12216ae995f63c1606f1a">&#9670;&nbsp;</a></span>d2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::d2 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(-1:n), intent(in)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>d2f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine computes the second derivative of function evaluated on the meshpoints 1,...,npt. The input is the function f with extrapolated values in -1, 0. Modified by M. Shelley. </p>
<dl class="section author"><dt>Author</dt><dd>A. Pastore, M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of meshpoints </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Input function (1:n) with extrapolated values in -1,0 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Step size </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d2f</td><td>Array for second derivatives </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_aafc8447e9af12216ae995f63c1606f1a_icgraph.png" border="0" usemap="#namespaceroutines_aafc8447e9af12216ae995f63c1606f1a_icgraph" alt=""/></div>
<map name="namespaceroutines_aafc8447e9af12216ae995f63c1606f1a_icgraph" id="namespaceroutines_aafc8447e9af12216ae995f63c1606f1a_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="363,5,501,32"/>
<area shape="rect" id="node6" href="namespaceroutines.html#a635a2461a6c20207dd3b268842381ce3" title="Subroutine to carry out Laplacian in spherical symmetry. " alt="" coords="144,31,315,57"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="1027,5,1065,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="549,31,736,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="784,31,979,57"/>
</map>
</div>

</div>
</div>
<a id="ac563b00969cb307d71ebc02aaef0a3b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac563b00969cb307d71ebc02aaef0a3b4">&#9670;&nbsp;</a></span>d3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::d3 </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(-2:n), intent(in)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>d3f_dr3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate third derivative of function f evaluated on evenly-spaced meshpoints from 1 to n. Works with extrapolated values in -2,-1,0. Uses 7-point stencil. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Input function (1:n) with extrapolated values in -2,-1,0 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d3f_dr3</td><td>Array for third derivative </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_ac563b00969cb307d71ebc02aaef0a3b4_icgraph.png" border="0" usemap="#namespaceroutines_ac563b00969cb307d71ebc02aaef0a3b4_icgraph" alt=""/></div>
<map name="namespaceroutines_ac563b00969cb307d71ebc02aaef0a3b4_icgraph" id="namespaceroutines_ac563b00969cb307d71ebc02aaef0a3b4_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="144,5,283,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="808,5,847,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="331,31,517,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="565,31,760,57"/>
</map>
</div>

</div>
</div>
<a id="a6d38e9b19f2e939feb7840d2575fbb56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d38e9b19f2e939feb7840d2575fbb56">&#9670;&nbsp;</a></span>d4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::d4 </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(-2:n), intent(in)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>d4f_dr4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate fourth derivative of function f evaluated on evenly-spaced meshpoints from 1 to n. Works with extrapolated values in -2,-1,0. Uses 7-point stencil. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Input function (1:n) with extrapolated values in -2,-1,0 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d4f_dr4</td><td>Array for fourth derivative </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a6d38e9b19f2e939feb7840d2575fbb56_icgraph.png" border="0" usemap="#namespaceroutines_a6d38e9b19f2e939feb7840d2575fbb56_icgraph" alt=""/></div>
<map name="namespaceroutines_a6d38e9b19f2e939feb7840d2575fbb56_icgraph" id="namespaceroutines_a6d38e9b19f2e939feb7840d2575fbb56_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="144,5,283,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="808,5,847,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="331,31,517,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="565,31,760,57"/>
</map>
</div>

</div>
</div>
<a id="ae7bc716d30ef4d9ecece5daa22324b77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7bc716d30ef4d9ecece5daa22324b77">&#9670;&nbsp;</a></span>deallocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::deallocate_arrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to deallocate arrays for all densities and effective masses, and for their derivatives. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_ae7bc716d30ef4d9ecece5daa22324b77_icgraph.png" border="0" usemap="#namespaceroutines_ae7bc716d30ef4d9ecece5daa22324b77_icgraph" alt=""/></div>
<map name="namespaceroutines_ae7bc716d30ef4d9ecece5daa22324b77_icgraph" id="namespaceroutines_ae7bc716d30ef4d9ecece5daa22324b77_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="188,13,227,39"/>
</map>
</div>

</div>
</div>
<a id="a27ad9ac802069004010c9759fecced92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27ad9ac802069004010c9759fecced92">&#9670;&nbsp;</a></span>deallocate_mesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::deallocate_mesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to deallocate array for r. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a27ad9ac802069004010c9759fecced92_icgraph.png" border="0" usemap="#namespaceroutines_a27ad9ac802069004010c9759fecced92_icgraph" alt=""/></div>
<map name="namespaceroutines_a27ad9ac802069004010c9759fecced92_icgraph" id="namespaceroutines_a27ad9ac802069004010c9759fecced92_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="228,5,267,32"/>
</map>
</div>

</div>
</div>
<a id="a74ed186c93b400a14428192e1cb7a0b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74ed186c93b400a14428192e1cb7a0b2">&#9670;&nbsp;</a></span>eval_coulomb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::eval_coulomb </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>prot_dens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>calc_exchange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to evaluate the Coulomb potentials and energy densities, using either the proton or charge density. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">prot_dens</td><td>Density to use (proton or charge) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">calc_exchange</td><td>Whether to calculate exchange potential </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a74ed186c93b400a14428192e1cb7a0b2_cgraph.png" border="0" usemap="#namespaceroutines_a74ed186c93b400a14428192e1cb7a0b2_cgraph" alt=""/></div>
<map name="namespaceroutines_a74ed186c93b400a14428192e1cb7a0b2_cgraph" id="namespaceroutines_a74ed186c93b400a14428192e1cb7a0b2_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8" title="Function to integrate a density or field over the whole W&#45;S cell, using Simpson&#39;s rule (+ Simpson&#39;s 3..." alt="" coords="209,5,352,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a74ed186c93b400a14428192e1cb7a0b2_icgraph.png" border="0" usemap="#namespaceroutines_a74ed186c93b400a14428192e1cb7a0b2_icgraph" alt=""/></div>
<map name="namespaceroutines_a74ed186c93b400a14428192e1cb7a0b2_icgraph" id="namespaceroutines_a74ed186c93b400a14428192e1cb7a0b2_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="687,5,725,32"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="209,31,396,57"/>
<area shape="rect" id="node4" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="444,31,639,57"/>
</map>
</div>

</div>
</div>
<a id="a0b55cc503c7168299be63556e2602bd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b55cc503c7168299be63556e2602bd0">&#9670;&nbsp;</a></span>eval_electrons()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::eval_electrons </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to evaluate the proton-electron potential which contributes to <img class="formulaInl" alt="$U_q$" src="form_18.png"/>, all energy contributions, and the pressure, coming from a homogeneous electron gas. Also calculates the electron chemical potential. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a0b55cc503c7168299be63556e2602bd0_cgraph.png" border="0" usemap="#namespaceroutines_a0b55cc503c7168299be63556e2602bd0_cgraph" alt=""/></div>
<map name="namespaceroutines_a0b55cc503c7168299be63556e2602bd0_cgraph" id="namespaceroutines_a0b55cc503c7168299be63556e2602bd0_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8" title="Function to integrate a density or field over the whole W&#45;S cell, using Simpson&#39;s rule (+ Simpson&#39;s 3..." alt="" coords="213,5,356,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a0b55cc503c7168299be63556e2602bd0_icgraph.png" border="0" usemap="#namespaceroutines_a0b55cc503c7168299be63556e2602bd0_icgraph" alt=""/></div>
<map name="namespaceroutines_a0b55cc503c7168299be63556e2602bd0_icgraph" id="namespaceroutines_a0b55cc503c7168299be63556e2602bd0_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="691,5,729,32"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="213,31,400,57"/>
<area shape="rect" id="node4" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="448,31,643,57"/>
</map>
</div>

</div>
</div>
<a id="aa995449a9eb9c404dbd756bdbea180a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa995449a9eb9c404dbd756bdbea180a2">&#9670;&nbsp;</a></span>eval_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::eval_fields </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives), spin-orbit fields, spin current densities (and derivatives) </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_aa995449a9eb9c404dbd756bdbea180a2_cgraph.png" border="0" usemap="#namespaceroutines_aa995449a9eb9c404dbd756bdbea180a2_cgraph" alt=""/></div>
<map name="namespaceroutines_aa995449a9eb9c404dbd756bdbea180a2_cgraph" id="namespaceroutines_aa995449a9eb9c404dbd756bdbea180a2_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#af143340288720f8019e944ec7110a84e" title="Subroutine to extrapolate back 3 points on the r mesh, to faciliate the calculation of first and seco..." alt="" coords="207,5,347,47"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a92e52c281532c938dfa10d85404a367a" title="This subroutine computes the first derivative of function evaluated on the meshpoints 1..." alt="" coords="232,71,323,98"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a635a2461a6c20207dd3b268842381ce3" title="Subroutine to carry out Laplacian in spherical symmetry. " alt="" coords="192,122,363,149"/>
<area shape="rect" id="node5" href="namespaceroutines.html#aafc8447e9af12216ae995f63c1606f1a" title="This subroutine computes the second derivative of function evaluated on the meshpoints 1..." alt="" coords="421,147,512,174"/>
<area shape="rect" id="node6" href="namespaceroutines.html#a701f911aa939448c5bee0589d57369ca" title="Subroutine to calculate the effective mass ratio &#160;for neutrons or protons, for standard Skyrme or for..." alt="" coords="215,223,340,250"/>
<area shape="rect" id="node8" href="namespaceroutines.html#a8c520afea1e9ca6698a0792fbac37e7a" title="Function to calculate the spin&#45;orbit field &#160;for neutrons or protons. " alt="" coords="212,274,343,301"/>
<area shape="rect" id="node9" href="namespaceroutines.html#af03f37f9deca52ef9a56287f50b982a1" title="Subroutine to calculate the second&#45;order contributions to the spin current density &#160;for neutrons or p..." alt="" coords="208,325,347,351"/>
<area shape="rect" id="node10" href="namespaceroutines.html#a136b7a1f0387466390decb98ce91c152" title="Subroutine to calculate the second&#45;order contributions to the divergence of the current density &#160;for ..." alt="" coords="215,376,339,417"/>
<area shape="rect" id="node11" href="namespaceroutines.html#ac563b00969cb307d71ebc02aaef0a3b4" title="Subroutine to calculate third derivative of function f evaluated on evenly&#45;spaced meshpoints from 1 t..." alt="" coords="232,442,323,469"/>
<area shape="rect" id="node12" href="namespaceroutines.html#a6d38e9b19f2e939feb7840d2575fbb56" title="Subroutine to calculate fourth derivative of function f evaluated on evenly&#45;spaced meshpoints from 1 ..." alt="" coords="232,493,323,519"/>
<area shape="rect" id="node13" href="namespaceroutines.html#a014fed5fe5fbc19302e7cbc651ba59bd" title="Subroutine to calculate the fourth&#45;order contributions to the spin current density &#160;for neutrons or p..." alt="" coords="208,543,347,570"/>
<area shape="rect" id="node14" href="namespaceroutines.html#a7f66729f05be35eda4266dbf47eda026" title="Subroutine to calculate the fourth&#45;order contributions to the divergence of the current density &#160;for ..." alt="" coords="215,595,339,636"/>
<area shape="rect" id="node15" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8" title="Function to integrate a density or field over the whole W&#45;S cell, using Simpson&#39;s rule (+ Simpson&#39;s 3..." alt="" coords="206,661,349,687"/>
<area shape="rect" id="node7" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b" title="routines::str2int" alt="" coords="411,223,523,250"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_aa995449a9eb9c404dbd756bdbea180a2_icgraph.png" border="0" usemap="#namespaceroutines_aa995449a9eb9c404dbd756bdbea180a2_icgraph" alt=""/></div>
<map name="namespaceroutines_aa995449a9eb9c404dbd756bdbea180a2_icgraph" id="namespaceroutines_aa995449a9eb9c404dbd756bdbea180a2_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="669,5,708,32"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="192,31,379,57"/>
<area shape="rect" id="node4" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="427,31,621,57"/>
</map>
</div>

</div>
</div>
<a id="ae210968d134fbcc79297971cc4fefb82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae210968d134fbcc79297971cc4fefb82">&#9670;&nbsp;</a></span>eval_skyrme_energy_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::eval_skyrme_energy_density </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to evaluate the Skyrme energy density, after first separately evaluating the field energy density. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_ae210968d134fbcc79297971cc4fefb82_cgraph.png" border="0" usemap="#namespaceroutines_ae210968d134fbcc79297971cc4fefb82_cgraph" alt=""/></div>
<map name="namespaceroutines_ae210968d134fbcc79297971cc4fefb82_cgraph" id="namespaceroutines_ae210968d134fbcc79297971cc4fefb82_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b" title="routines::str2int" alt="" coords="219,5,331,32"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8" title="Function to integrate a density or field over the whole W&#45;S cell, using Simpson&#39;s rule (+ Simpson&#39;s 3..." alt="" coords="204,56,347,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_ae210968d134fbcc79297971cc4fefb82_icgraph.png" border="0" usemap="#namespaceroutines_ae210968d134fbcc79297971cc4fefb82_icgraph" alt=""/></div>
<map name="namespaceroutines_ae210968d134fbcc79297971cc4fefb82_icgraph" id="namespaceroutines_ae210968d134fbcc79297971cc4fefb82_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="681,13,720,39"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="204,38,391,65"/>
<area shape="rect" id="node4" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="439,38,633,65"/>
</map>
</div>

</div>
</div>
<a id="a97bfcff7e603cf9df3dcd48ae21b4612"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97bfcff7e603cf9df3dcd48ae21b4612">&#9670;&nbsp;</a></span>eval_tau_etf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::eval_tau_etf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the kinetic energy density <img class="formulaInl" alt="$\tau_{ETF}$" src="form_19.png"/> with the (extended) Thomas-Fermi approximation at order specified by "etf_order". </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a97bfcff7e603cf9df3dcd48ae21b4612_cgraph.png" border="0" usemap="#namespaceroutines_a97bfcff7e603cf9df3dcd48ae21b4612_cgraph" alt=""/></div>
<map name="namespaceroutines_a97bfcff7e603cf9df3dcd48ae21b4612_cgraph" id="namespaceroutines_a97bfcff7e603cf9df3dcd48ae21b4612_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a421a5d2cca448f46b0dfb9bcdeec1111" title="Function to calculate the zeroth&#45;order contribution to the kinetic energy density for neutrons or pro..." alt="" coords="210,5,350,32"/>
<area shape="rect" id="node3" href="namespaceroutines.html#aaa80f6938f2b9c661821fa8956f8deef" title="Function to calculate the local second&#45;order contribution to the kinetic energy density for neutrons ..." alt="" coords="205,56,355,83"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a72bf2988651a9f3251dfb338ad1a7eca" title="Subroutine to calculate the non&#45;local second&#45;order contribution to the kinetic energy density for neu..." alt="" coords="202,107,358,133"/>
<area shape="rect" id="node5" href="namespaceroutines.html#a9c7e02754e0ae8816b1bfeab92df6bc8" title="Subroutine to calculate the fourth&#45;order contributions to the kinetic energy density (without spin&#45;or..." alt="" coords="217,158,343,199"/>
<area shape="rect" id="node6" href="namespaceroutines.html#a8825f02bb2ac98507fff5024d9b54c8f" title="Subroutine to calculate the fourth&#45;order contributions to the kinetic energy density (spin&#45;orbit cont..." alt="" coords="200,224,360,251"/>
<area shape="rect" id="node7" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8" title="Function to integrate a density or field over the whole W&#45;S cell, using Simpson&#39;s rule (+ Simpson&#39;s 3..." alt="" coords="209,275,351,301"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a97bfcff7e603cf9df3dcd48ae21b4612_icgraph.png" border="0" usemap="#namespaceroutines_a97bfcff7e603cf9df3dcd48ae21b4612_icgraph" alt=""/></div>
<map name="namespaceroutines_a97bfcff7e603cf9df3dcd48ae21b4612_icgraph" id="namespaceroutines_a97bfcff7e603cf9df3dcd48ae21b4612_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="677,5,716,32"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="200,31,387,57"/>
<area shape="rect" id="node4" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="435,31,629,57"/>
</map>
</div>

</div>
</div>
<a id="a6ee5e5cd7ce81b013d18b19f5f9a4092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ee5e5cd7ce81b013d18b19f5f9a4092">&#9670;&nbsp;</a></span>eval_u_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::eval_u_q </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to evaluate the central fields <img class="formulaInl" alt="$U_q$" src="form_18.png"/>. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a6ee5e5cd7ce81b013d18b19f5f9a4092_cgraph.png" border="0" usemap="#namespaceroutines_a6ee5e5cd7ce81b013d18b19f5f9a4092_cgraph" alt=""/></div>
<map name="namespaceroutines_a6ee5e5cd7ce81b013d18b19f5f9a4092_cgraph" id="namespaceroutines_a6ee5e5cd7ce81b013d18b19f5f9a4092_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a2a44c591985c939162dabdeab4a4ced8" title="Function to calculate the central potential &#160;for neutrons or protons, for standard Skyrme or for BSk ..." alt="" coords="181,5,309,32"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b" title="routines::str2int" alt="" coords="357,5,469,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a6ee5e5cd7ce81b013d18b19f5f9a4092_icgraph.png" border="0" usemap="#namespaceroutines_a6ee5e5cd7ce81b013d18b19f5f9a4092_icgraph" alt=""/></div>
<map name="namespaceroutines_a6ee5e5cd7ce81b013d18b19f5f9a4092_icgraph" id="namespaceroutines_a6ee5e5cd7ce81b013d18b19f5f9a4092_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="659,5,697,32"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="181,31,368,57"/>
<area shape="rect" id="node4" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="416,31,611,57"/>
</map>
</div>

</div>
</div>
<a id="a93de76f3b26ead66893f46dc4892dbcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93de76f3b26ead66893f46dc4892dbcb">&#9670;&nbsp;</a></span>eval_ws_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::eval_ws_quantities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in the WS cell with densities <img class="formulaInl" alt="$rho_q$" src="form_20.png"/>. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a93de76f3b26ead66893f46dc4892dbcb_cgraph.png" border="0" usemap="#namespaceroutines_a93de76f3b26ead66893f46dc4892dbcb_cgraph" alt=""/></div>
<map name="namespaceroutines_a93de76f3b26ead66893f46dc4892dbcb_cgraph" id="namespaceroutines_a93de76f3b26ead66893f46dc4892dbcb_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a407a248748ce7c0e2e9e5dce03cc9415" title="Function to calculate the neutron or proton density at a given radius r, using supplied input paramet..." alt="" coords="260,331,399,357"/>
<area shape="rect" id="node3" href="namespaceparameters.html#a55242f635842d12dbb53d66ae9248b93" title="Subroutine to initialise Skyrme force parameters with values for a given force specified in &#39;input..." alt="" coords="240,381,419,408"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a0b8346e8e5457d6befb48b0ac56f4fdf" title="Subroutine to calculate the number of particles in the Wigner&#45;Seitz cell. " alt="" coords="255,906,404,947"/>
<area shape="rect" id="node6" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="260,432,399,459"/>
<area shape="rect" id="node12" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b" title="routines::str2int" alt="" coords="685,711,797,737"/>
<area shape="rect" id="node20" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612" title="Subroutine to calculate the kinetic energy density &#160;with the (extended) Thomas&#45;Fermi approximation at..." alt="" coords="256,804,403,831"/>
<area shape="rect" id="node26" href="namespaceroutines.html#afb83677ec76758dadc35de4b01bac45c" title="Subroutine to calculate the charge density from the matter densities. Modified by M..." alt="" coords="272,855,387,881"/>
<area shape="rect" id="node27" href="namespaceroutines.html#a74ed186c93b400a14428192e1cb7a0b2" title="Subroutine to evaluate the Coulomb potentials and energy densities, using either the proton or charge..." alt="" coords="251,972,407,999"/>
<area shape="rect" id="node28" href="namespaceroutines.html#a0b55cc503c7168299be63556e2602bd0" title="Subroutine to evaluate the proton&#45;electron potential which contributes to , all energy contributions..." alt="" coords="249,1023,409,1049"/>
<area shape="rect" id="node29" href="namespaceroutines.html#a6ee5e5cd7ce81b013d18b19f5f9a4092" title="Subroutine to evaluate the central fields . " alt="" coords="265,732,393,759"/>
<area shape="rect" id="node31" href="namespaceroutines.html#ae210968d134fbcc79297971cc4fefb82" title="Subroutine to evaluate the Skyrme energy density, after first separately evaluating the field energy ..." alt="" coords="254,1074,405,1115"/>
<area shape="rect" id="node32" href="namespaceroutines.html#a383e2bf5a1fa37fbf95dd5f6ddbcc6be" title="Subroutine to calculate the nuclear contribution to the pressure, and then the total pressure..." alt="" coords="266,1140,393,1167"/>
<area shape="rect" id="node5" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8" title="Function to integrate a density or field over the whole W&#45;S cell, using Simpson&#39;s rule (+ Simpson&#39;s 3..." alt="" coords="481,1031,623,1057"/>
<area shape="rect" id="node7" href="namespaceroutines.html#af143340288720f8019e944ec7110a84e" title="Subroutine to extrapolate back 3 points on the r mesh, to faciliate the calculation of first and seco..." alt="" coords="482,341,622,382"/>
<area shape="rect" id="node8" href="namespaceroutines.html#a92e52c281532c938dfa10d85404a367a" title="This subroutine computes the first derivative of function evaluated on the meshpoints 1..." alt="" coords="507,407,597,433"/>
<area shape="rect" id="node9" href="namespaceroutines.html#a635a2461a6c20207dd3b268842381ce3" title="Subroutine to carry out Laplacian in spherical symmetry. " alt="" coords="467,508,637,535"/>
<area shape="rect" id="node10" href="namespaceroutines.html#aafc8447e9af12216ae995f63c1606f1a" title="This subroutine computes the second derivative of function evaluated on the meshpoints 1..." alt="" coords="696,483,787,509"/>
<area shape="rect" id="node11" href="namespaceroutines.html#a701f911aa939448c5bee0589d57369ca" title="Subroutine to calculate the effective mass ratio &#160;for neutrons or protons, for standard Skyrme or for..." alt="" coords="489,609,615,636"/>
<area shape="rect" id="node13" href="namespaceroutines.html#a8c520afea1e9ca6698a0792fbac37e7a" title="Function to calculate the spin&#45;orbit field &#160;for neutrons or protons. " alt="" coords="487,559,617,585"/>
<area shape="rect" id="node14" href="namespaceroutines.html#af03f37f9deca52ef9a56287f50b982a1" title="Subroutine to calculate the second&#45;order contributions to the spin current density &#160;for neutrons or p..." alt="" coords="483,5,621,32"/>
<area shape="rect" id="node15" href="namespaceroutines.html#a136b7a1f0387466390decb98ce91c152" title="Subroutine to calculate the second&#45;order contributions to the divergence of the current density &#160;for ..." alt="" coords="490,57,614,98"/>
<area shape="rect" id="node16" href="namespaceroutines.html#ac563b00969cb307d71ebc02aaef0a3b4" title="Subroutine to calculate third derivative of function f evaluated on evenly&#45;spaced meshpoints from 1 t..." alt="" coords="507,123,597,149"/>
<area shape="rect" id="node17" href="namespaceroutines.html#a6d38e9b19f2e939feb7840d2575fbb56" title="Subroutine to calculate fourth derivative of function f evaluated on evenly&#45;spaced meshpoints from 1 ..." alt="" coords="507,173,597,200"/>
<area shape="rect" id="node18" href="namespaceroutines.html#a014fed5fe5fbc19302e7cbc651ba59bd" title="Subroutine to calculate the fourth&#45;order contributions to the spin current density &#160;for neutrons or p..." alt="" coords="483,224,621,251"/>
<area shape="rect" id="node19" href="namespaceroutines.html#a7f66729f05be35eda4266dbf47eda026" title="Subroutine to calculate the fourth&#45;order contributions to the divergence of the current density &#160;for ..." alt="" coords="490,275,614,317"/>
<area shape="rect" id="node21" href="namespaceroutines.html#a421a5d2cca448f46b0dfb9bcdeec1111" title="Function to calculate the zeroth&#45;order contribution to the kinetic energy density for neutrons or pro..." alt="" coords="482,812,622,839"/>
<area shape="rect" id="node22" href="namespaceroutines.html#aaa80f6938f2b9c661821fa8956f8deef" title="Function to calculate the local second&#45;order contribution to the kinetic energy density for neutrons ..." alt="" coords="477,863,627,889"/>
<area shape="rect" id="node23" href="namespaceroutines.html#a72bf2988651a9f3251dfb338ad1a7eca" title="Subroutine to calculate the non&#45;local second&#45;order contribution to the kinetic energy density for neu..." alt="" coords="474,913,630,940"/>
<area shape="rect" id="node24" href="namespaceroutines.html#a9c7e02754e0ae8816b1bfeab92df6bc8" title="Subroutine to calculate the fourth&#45;order contributions to the kinetic energy density (without spin&#45;or..." alt="" coords="489,965,615,1006"/>
<area shape="rect" id="node25" href="namespaceroutines.html#a8825f02bb2ac98507fff5024d9b54c8f" title="Subroutine to calculate the fourth&#45;order contributions to the kinetic energy density (spin&#45;orbit cont..." alt="" coords="472,761,632,788"/>
<area shape="rect" id="node30" href="namespaceroutines.html#a2a44c591985c939162dabdeab4a4ced8" title="Function to calculate the central potential &#160;for neutrons or protons, for standard Skyrme or for BSk ..." alt="" coords="488,711,616,737"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a93de76f3b26ead66893f46dc4892dbcb_icgraph.png" border="0" usemap="#namespaceroutines_a93de76f3b26ead66893f46dc4892dbcb_icgraph" alt=""/></div>
<map name="namespaceroutines_a93de76f3b26ead66893f46dc4892dbcb_icgraph" id="namespaceroutines_a93de76f3b26ead66893f46dc4892dbcb_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="240,5,435,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="483,5,521,32"/>
</map>
</div>

</div>
</div>
<a id="af143340288720f8019e944ec7110a84e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af143340288720f8019e944ec7110a84e">&#9670;&nbsp;</a></span>extrapolate_back_3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::extrapolate_back_3 </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to extrapolate back 3 points on the r mesh, to faciliate the calculation of first and second derivatives using a 5-point stencil. Values in grid start at 4, extrapolated values are put in elements 3,2,1. Coefficients come from solving 4th-order polynomial, assuming that f'(0) = 0, and f(-h) = f(h). </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">grid</td><td>Array of quantity evaluated on r mesh, with 3 elements before r = dr </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_af143340288720f8019e944ec7110a84e_icgraph.png" border="0" usemap="#namespaceroutines_af143340288720f8019e944ec7110a84e_icgraph" alt=""/></div>
<map name="namespaceroutines_af143340288720f8019e944ec7110a84e_icgraph" id="namespaceroutines_af143340288720f8019e944ec7110a84e_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="193,13,332,39"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="857,13,896,39"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="380,38,567,65"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="615,38,809,65"/>
</map>
</div>

</div>
</div>
<a id="a5caa9b33bdf3c960b6bb3bfa96771181"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5caa9b33bdf3c960b6bb3bfa96771181">&#9670;&nbsp;</a></span>initialise_uniform_mesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::initialise_uniform_mesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate number of mesh points for a uniform grid, allocate array for r, and then populate r with the mesh points. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a5caa9b33bdf3c960b6bb3bfa96771181_icgraph.png" border="0" usemap="#namespaceroutines_a5caa9b33bdf3c960b6bb3bfa96771181_icgraph" alt=""/></div>
<map name="namespaceroutines_a5caa9b33bdf3c960b6bb3bfa96771181_icgraph" id="namespaceroutines_a5caa9b33bdf3c960b6bb3bfa96771181_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="176,13,215,39"/>
</map>
</div>

</div>
</div>
<a id="a635a2461a6c20207dd3b268842381ce3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a635a2461a6c20207dd3b268842381ce3">&#9670;&nbsp;</a></span>lap_sphe_symm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::lap_sphe_symm </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(-2:n), intent(in)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(in)&#160;</td>
          <td class="paramname"><em>df_dr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(1:n), intent(inout)&#160;</td>
          <td class="paramname"><em>d2f_dr2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to carry out Laplacian in spherical symmetry. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Input function (1:n) with extrapolated values in -2,-1,0 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">df_dr</td><td>First derivative array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d2f_dr2</td><td>Array for Laplacian </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a635a2461a6c20207dd3b268842381ce3_cgraph.png" border="0" usemap="#namespaceroutines_a635a2461a6c20207dd3b268842381ce3_cgraph" alt=""/></div>
<map name="namespaceroutines_a635a2461a6c20207dd3b268842381ce3_cgraph" id="namespaceroutines_a635a2461a6c20207dd3b268842381ce3_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aafc8447e9af12216ae995f63c1606f1a" title="This subroutine computes the second derivative of function evaluated on the meshpoints 1..." alt="" coords="224,5,315,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a635a2461a6c20207dd3b268842381ce3_icgraph.png" border="0" usemap="#namespaceroutines_a635a2461a6c20207dd3b268842381ce3_icgraph" alt=""/></div>
<map name="namespaceroutines_a635a2461a6c20207dd3b268842381ce3_icgraph" id="namespaceroutines_a635a2461a6c20207dd3b268842381ce3_icgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="224,5,363,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="888,5,927,32"/>
<area shape="rect" id="node4" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="411,31,597,57"/>
<area shape="rect" id="node5" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="645,31,840,57"/>
</map>
</div>

</div>
</div>
<a id="a383e2bf5a1fa37fbf95dd5f6ddbcc6be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a383e2bf5a1fa37fbf95dd5f6ddbcc6be">&#9670;&nbsp;</a></span>pressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::pressure </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the nuclear contribution to the pressure, and then the total pressure. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a383e2bf5a1fa37fbf95dd5f6ddbcc6be_cgraph.png" border="0" usemap="#namespaceroutines_a383e2bf5a1fa37fbf95dd5f6ddbcc6be_cgraph" alt=""/></div>
<map name="namespaceroutines_a383e2bf5a1fa37fbf95dd5f6ddbcc6be_cgraph" id="namespaceroutines_a383e2bf5a1fa37fbf95dd5f6ddbcc6be_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b" title="routines::str2int" alt="" coords="180,5,292,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a383e2bf5a1fa37fbf95dd5f6ddbcc6be_icgraph.png" border="0" usemap="#namespaceroutines_a383e2bf5a1fa37fbf95dd5f6ddbcc6be_icgraph" alt=""/></div>
<map name="namespaceroutines_a383e2bf5a1fa37fbf95dd5f6ddbcc6be_icgraph" id="namespaceroutines_a383e2bf5a1fa37fbf95dd5f6ddbcc6be_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="657,5,696,32"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="180,31,367,57"/>
<area shape="rect" id="node4" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="415,31,609,57"/>
</map>
</div>

</div>
</div>
<a id="a8146fb4359e556bad19f882b8aabfc4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8146fb4359e556bad19f882b8aabfc4b">&#9670;&nbsp;</a></span>str2int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function routines::str2int </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>string</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a8146fb4359e556bad19f882b8aabfc4b_icgraph.png" border="0" usemap="#namespaceroutines_a8146fb4359e556bad19f882b8aabfc4b_icgraph" alt=""/></div>
<map name="namespaceroutines_a8146fb4359e556bad19f882b8aabfc4b_icgraph" id="namespaceroutines_a8146fb4359e556bad19f882b8aabfc4b_icgraph">
<area shape="rect" id="node2" href="namespacepairing.html#abad69eb8cb33077add1b9da84bff7c55" title="Function to calculate the pairing gap in infinite neutron matter, for specified density and effective..." alt="" coords="189,5,309,32"/>
<area shape="rect" id="node6" href="namespacepairing.html#a37440fb2ff0d8a3495d051f3f14c9107" title="Function to solve gap equation at given chemical potential &quot;mu_p&quot;, returning the (BCS) number of prot..." alt="" coords="165,56,332,83"/>
<area shape="rect" id="node8" href="namespaceroutines.html#a701f911aa939448c5bee0589d57369ca" title="Subroutine to calculate the effective mass ratio &#160;for neutrons or protons, for standard Skyrme or for..." alt="" coords="186,107,311,133"/>
<area shape="rect" id="node10" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="579,157,765,184"/>
<area shape="rect" id="node11" href="namespaceroutines.html#a2a44c591985c939162dabdeab4a4ced8" title="Function to calculate the central potential &#160;for neutrons or protons, for standard Skyrme or for BSk ..." alt="" coords="185,208,313,235"/>
<area shape="rect" id="node13" href="namespaceroutines.html#ae210968d134fbcc79297971cc4fefb82" title="Subroutine to evaluate the Skyrme energy density, after first separately evaluating the field energy ..." alt="" coords="380,259,531,301"/>
<area shape="rect" id="node14" href="namespaceroutines.html#a383e2bf5a1fa37fbf95dd5f6ddbcc6be" title="Subroutine to calculate the nuclear contribution to the pressure, and then the total pressure..." alt="" coords="392,325,519,352"/>
<area shape="rect" id="node3" href="namespacepairing.html#ac34989a934af1e6a63131c619426c5aa" title="Subroutine to calculate the pairing energy for the WS cell, using the method specified in &quot;input..." alt="" coords="605,5,739,32"/>
<area shape="rect" id="node4" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="813,56,1008,83"/>
<area shape="rect" id="node5" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="1056,208,1095,235"/>
<area shape="rect" id="node7" href="namespacepairing.html#a693cac2cfa7fcb7ad19984fefe20495c" title="Subroutine to perform BCS for protons. " alt="" coords="603,56,741,83"/>
<area shape="rect" id="node9" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="386,107,525,133"/>
<area shape="rect" id="node12" href="namespaceroutines.html#a6ee5e5cd7ce81b013d18b19f5f9a4092" title="Subroutine to evaluate the central fields . " alt="" coords="391,208,519,235"/>
</map>
</div>

</div>
</div>
<a id="a81e61269fb96b5478fd7140a1f185ec1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81e61269fb96b5478fd7140a1f185ec1">&#9670;&nbsp;</a></span>write_densities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::write_densities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to write neutron and proton densities to files. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a81e61269fb96b5478fd7140a1f185ec1_icgraph.png" border="0" usemap="#namespaceroutines_a81e61269fb96b5478fd7140a1f185ec1_icgraph" alt=""/></div>
<map name="namespaceroutines_a81e61269fb96b5478fd7140a1f185ec1_icgraph" id="namespaceroutines_a81e61269fb96b5478fd7140a1f185ec1_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="216,5,411,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="459,5,497,32"/>
</map>
</div>

</div>
</div>
<a id="a4a59953c814b7fa48f2c4bf31d1763a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a59953c814b7fa48f2c4bf31d1763a2">&#9670;&nbsp;</a></span>write_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::write_fields </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to write neutron and proton fields to files. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a4a59953c814b7fa48f2c4bf31d1763a2_icgraph.png" border="0" usemap="#namespaceroutines_a4a59953c814b7fa48f2c4bf31d1763a2_icgraph" alt=""/></div>
<map name="namespaceroutines_a4a59953c814b7fa48f2c4bf31d1763a2_icgraph" id="namespaceroutines_a4a59953c814b7fa48f2c4bf31d1763a2_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="196,5,391,32"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="439,5,477,32"/>
</map>
</div>

</div>
</div>
<a id="ad51ac6c5da6056a5346d7b15b3fbe7b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad51ac6c5da6056a5346d7b15b3fbe7b4">&#9670;&nbsp;</a></span>write_sp_states_p()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine routines::write_sp_states_p </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to write proton single particle energies to file, and extra details if BCS has been performed. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_ad51ac6c5da6056a5346d7b15b3fbe7b4_icgraph.png" border="0" usemap="#namespaceroutines_ad51ac6c5da6056a5346d7b15b3fbe7b4_icgraph" alt=""/></div>
<map name="namespaceroutines_ad51ac6c5da6056a5346d7b15b3fbe7b4_icgraph" id="namespaceroutines_ad51ac6c5da6056a5346d7b15b3fbe7b4_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="179,13,373,39"/>
<area shape="rect" id="node3" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="421,13,460,39"/>
</map>
</div>

</div>
</div>
<a id="a5737b4327dcaa959a9ee519e4fca42e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5737b4327dcaa959a9ee519e4fca42e8">&#9670;&nbsp;</a></span>ws_integral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function routines::ws_integral </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>quantity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to integrate a density or field over the whole W-S cell, using Simpson's rule (+ Simpson's 3/8 rule if odd number of points) </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">quantity</td><td>Array of quantity, evaluated on r mesh, to be integrated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_max</td><td>Maximum mesh point in array for integration </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceroutines_a5737b4327dcaa959a9ee519e4fca42e8_icgraph.png" border="0" usemap="#namespaceroutines_a5737b4327dcaa959a9ee519e4fca42e8_icgraph" alt=""/></div>
<map name="namespaceroutines_a5737b4327dcaa959a9ee519e4fca42e8_icgraph" id="namespaceroutines_a5737b4327dcaa959a9ee519e4fca42e8_icgraph">
<area shape="rect" id="node2" href="namespacepairing.html#ac34989a934af1e6a63131c619426c5aa" title="Subroutine to calculate the pairing energy for the WS cell, using the method specified in &quot;input..." alt="" coords="437,71,571,98"/>
<area shape="rect" id="node5" href="namespacepairing.html#a37440fb2ff0d8a3495d051f3f14c9107" title="Function to solve gap equation at given chemical potential &quot;mu_p&quot;, returning the (BCS) number of prot..." alt="" coords="196,122,363,149"/>
<area shape="rect" id="node7" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="210,173,349,199"/>
<area shape="rect" id="node9" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612" title="Subroutine to calculate the kinetic energy density &#160;with the (extended) Thomas&#45;Fermi approximation at..." alt="" coords="206,223,353,250"/>
<area shape="rect" id="node10" href="namespaceroutines.html#a74ed186c93b400a14428192e1cb7a0b2" title="Subroutine to evaluate the Coulomb potentials and energy densities, using either the proton or charge..." alt="" coords="201,274,357,301"/>
<area shape="rect" id="node11" href="namespaceroutines.html#a0b55cc503c7168299be63556e2602bd0" title="Subroutine to evaluate the proton&#45;electron potential which contributes to , all energy contributions..." alt="" coords="199,325,359,351"/>
<area shape="rect" id="node12" href="namespaceroutines.html#ae210968d134fbcc79297971cc4fefb82" title="Subroutine to evaluate the Skyrme energy density, after first separately evaluating the field energy ..." alt="" coords="204,376,355,417"/>
<area shape="rect" id="node13" href="namespaceroutines.html#a0b8346e8e5457d6befb48b0ac56f4fdf" title="Subroutine to calculate the number of particles in the Wigner&#45;Seitz cell. " alt="" coords="205,493,354,535"/>
<area shape="rect" id="node14" href="namespacestrutinsky.html#a7a348b225e6556c53687ee28ee31b316" title="Subroutine to calculate the Strutinsky shell correction energy for isospin . First, sum over occupied states of s.p. energies. Second, integrate over W&#45;S cell of smoothed ETF densities and fields. " alt="" coords="431,375,577,402"/>
<area shape="rect" id="node16" href="namespacestrutinsky.html#a2cc0d4130d68c345ffe3ffa73706e796" title="Subroutine to calculate the Strutinsky shell correction energy for protons, using BCS occupation prob..." alt="" coords="441,5,567,47"/>
<area shape="rect" id="node3" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="645,122,840,149"/>
<area shape="rect" id="node4" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="888,313,927,339"/>
<area shape="rect" id="node6" href="namespacepairing.html#a693cac2cfa7fcb7ad19984fefe20495c" title="Subroutine to perform BCS for protons. " alt="" coords="435,122,573,149"/>
<area shape="rect" id="node8" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="411,325,597,351"/>
<area shape="rect" id="node15" href="namespacetest.html#afde013e321ba30ada173fc343ca1fa6d" title="Subroutine to test the Strutinsky integral correction. " alt="" coords="665,350,820,377"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4433ed4e6fbf0c81f38d8df1749be025"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4433ed4e6fbf0c81f38d8df1749be025">&#9670;&nbsp;</a></span>file_unit_0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer routines::file_unit_0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a806b34a65a0678e540be124100a0f908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a806b34a65a0678e540be124100a0f908">&#9670;&nbsp;</a></span>file_unit_1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer routines::file_unit_1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unit numbers for opening files. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceroutines.html">routines</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
