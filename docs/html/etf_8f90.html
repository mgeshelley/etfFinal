<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Extended Thomas-Fermi: srcs/etf.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Extended Thomas-Fermi
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('etf_8f90.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">etf.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a77a926a33d4e2b4d7c47fa641fc32e57"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57">etf</a></td></tr>
<tr class="memdesc:a77a926a33d4e2b4d7c47fa641fc32e57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program to calculate the equation of state in the inner crust with the extended Thomas-Fermi (ETF) approach.  <a href="#a77a926a33d4e2b4d7c47fa641fc32e57">More...</a><br /></td></tr>
<tr class="separator:a77a926a33d4e2b4d7c47fa641fc32e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48fed0623ded12967501f647461fb1cb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb">total_energy_with_corrections</a> (write_files_print_info)</td></tr>
<tr class="memdesc:a48fed0623ded12967501f647461fb1cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energy, with pairing and shell corrections included. Write densities and fields to files, and all info to screen, if specified.  <a href="#a48fed0623ded12967501f647461fb1cb">More...</a><br /></td></tr>
<tr class="separator:a48fed0623ded12967501f647461fb1cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a77a926a33d4e2b4d7c47fa641fc32e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a926a33d4e2b4d7c47fa641fc32e57">&#9670;&nbsp;</a></span>etf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program etf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Program to calculate the equation of state in the inner crust with the extended Thomas-Fermi (ETF) approach. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="etf_8f90_a77a926a33d4e2b4d7c47fa641fc32e57_cgraph.png" border="0" usemap="#etf_8f90_a77a926a33d4e2b4d7c47fa641fc32e57_cgraph" alt=""/></div>
<map name="etf_8f90_a77a926a33d4e2b4d7c47fa641fc32e57_cgraph" id="etf_8f90_a77a926a33d4e2b4d7c47fa641fc32e57_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a5caa9b33bdf3c960b6bb3bfa96771181" title="Subroutine to calculate number of mesh points for a uniform grid, allocate array for r..." alt="" coords="128,419,251,461"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a0d41e4cd4e61ac1463c75055bf784e8b" title="Subroutine to allocate arrays for all densities and effective masses, and for their derivatives..." alt="" coords="129,485,250,526"/>
<area shape="rect" id="node4" href="etf_8f90.html#a48fed0623ded12967501f647461fb1cb" title="Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energ..." alt="" coords="92,1204,287,1231"/>
<area shape="rect" id="node7" href="namespaceparameters.html#a55242f635842d12dbb53d66ae9248b93" title="Subroutine to initialise Skyrme force parameters with values for a given force specified in &#39;input..." alt="" coords="569,1031,748,1057"/>
<area shape="rect" id="node8" href="namespaceroutines.html#a0b8346e8e5457d6befb48b0ac56f4fdf" title="Subroutine to calculate the number of particles in the Wigner&#45;Seitz cell. " alt="" coords="584,813,733,854"/>
<area shape="rect" id="node10" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="589,533,728,560"/>
<area shape="rect" id="node24" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612" title="Subroutine to calculate the kinetic energy density &#160;with the (extended) Thomas&#45;Fermi approximation at..." alt="" coords="585,711,732,737"/>
<area shape="rect" id="node31" href="namespaceroutines.html#a74ed186c93b400a14428192e1cb7a0b2" title="Subroutine to evaluate the Coulomb potentials and energy densities, using either the proton or charge..." alt="" coords="581,879,737,905"/>
<area shape="rect" id="node32" href="namespaceroutines.html#a0b55cc503c7168299be63556e2602bd0" title="Subroutine to evaluate the proton&#45;electron potential which contributes to , all energy contributions..." alt="" coords="579,1183,739,1209"/>
<area shape="rect" id="node33" href="namespaceroutines.html#a6ee5e5cd7ce81b013d18b19f5f9a4092" title="Subroutine to evaluate the central fields . " alt="" coords="595,1553,723,1580"/>
<area shape="rect" id="node35" href="namespaceroutines.html#ae210968d134fbcc79297971cc4fefb82" title="Subroutine to evaluate the Skyrme energy density, after first separately evaluating the field energy ..." alt="" coords="583,1335,734,1377"/>
<area shape="rect" id="node36" href="namespaceroutines.html#a383e2bf5a1fa37fbf95dd5f6ddbcc6be" title="Subroutine to calculate the nuclear contribution to the pressure, and then the total pressure..." alt="" coords="595,1452,722,1479"/>
<area shape="rect" id="node43" href="namespacestrutinsky.html#a6eeba7570095328226f37df3e89b7a18" title="Subroutine to allocate + initialise variables needed in &#39;boundary&#39; routine, and allocate arrays neede..." alt="" coords="356,1394,500,1435"/>
<area shape="rect" id="node54" href="namespacestrutinsky.html#a0a07c6adfd14cbf345bf96b70d3f5d82" title="Subroutine to deallocate arrays needed in &#39;boundary&#39; routine, and deallocate arrays needed for BCS..." alt="" coords="356,1459,500,1501"/>
<area shape="rect" id="node55" href="namespacetest.html#a2d72f655d80bac0b01030b9cbda3518f" title="Subroutine to read from &quot;test_input.in&quot; parameters used for test routines. " alt="" coords="111,1728,267,1755"/>
<area shape="rect" id="node56" href="namespacetest.html#ac81b1d59a968470b8ef8a165101df52c" title="Subroutine to calculate the density profiles using sample parameters. " alt="" coords="361,905,495,932"/>
<area shape="rect" id="node57" href="namespacetest.html#af860540d68e055817e3f618b7a04298a" title="Subroutine to test calculation of neutron and proton particle numbers. " alt="" coords="112,1779,267,1821"/>
<area shape="rect" id="node58" href="namespacetest.html#ac49b81619b874cdd8276af19d24675cc" title="Subroutine to test effective masses . " alt="" coords="122,1845,257,1872"/>
<area shape="rect" id="node59" href="namespacetest.html#a50469f436f9c4caa447dafc48e311558" title="Subroutine to test some derivatives of the total and individual densities. " alt="" coords="128,1897,251,1938"/>
<area shape="rect" id="node60" href="namespacetest.html#a377babe07d6ab6f0791233afee079582" title="Subroutine to test kinetic energy densities. " alt="" coords="130,1962,249,2003"/>
<area shape="rect" id="node61" href="namespacetest.html#a3e49a3b6fd835efb13dd446bfb6e8b1f" title="Subroutine to write spin current densities and spin&#45;orbit fields to file. " alt="" coords="113,2027,265,2069"/>
<area shape="rect" id="node62" href="namespacetest.html#a12069a39539c68f8d22f7eb4219d2e2b" title="Subroutine to write order&#45;by&#45;order comparison of kinetic densities to file. " alt="" coords="123,2093,256,2134"/>
<area shape="rect" id="node63" href="namespacetest.html#a5693dbb30b96995df35fa720f0ab1436" title="Subroutine to write spin central potentials to file. " alt="" coords="129,2158,249,2199"/>
<area shape="rect" id="node64" href="namespacetest.html#aa2a14f70fb7372abc970b6271f19417f" title="Subroutine to test calculation of Skyrme energy. " alt="" coords="112,2223,267,2265"/>
<area shape="rect" id="node65" href="namespacetest.html#ae4857dad0359d5f90718d5593398f8b3" title="Subroutine to test calculation of Coulomb energy. " alt="" coords="109,2289,270,2330"/>
<area shape="rect" id="node66" href="namespacetest.html#abeb5e336395994821e96838b809e4140" title="Subroutine to test calculation of single particle energies. " alt="" coords="353,483,503,509"/>
<area shape="rect" id="node67" href="namespacetest.html#afde013e321ba30ada173fc343ca1fa6d" title="Subroutine to test the Strutinsky integral correction. " alt="" coords="112,601,267,628"/>
<area shape="rect" id="node68" href="namespacetest.html#a8eb520f312c2647e714f169e9d5b8421" title="Subroutine to check different contributions to &#160;at 2nd order, for comparison with results in Bartel a..." alt="" coords="114,2354,265,2395"/>
<area shape="rect" id="node69" href="namespaceroutines.html#a27ad9ac802069004010c9759fecced92" title="Subroutine to deallocate array for r. " alt="" coords="102,2420,277,2447"/>
<area shape="rect" id="node70" href="namespaceroutines.html#ae7bc716d30ef4d9ecece5daa22324b77" title="Subroutine to deallocate arrays for all densities and effective masses, and for their derivatives..." alt="" coords="122,2471,257,2513"/>
<area shape="rect" id="node5" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="335,1073,521,1100"/>
<area shape="rect" id="node37" href="namespacepairing.html#ac34989a934af1e6a63131c619426c5aa" title="Subroutine to calculate the pairing energy for the WS cell, using the method specified in &quot;input..." alt="" coords="361,1292,495,1319"/>
<area shape="rect" id="node38" href="namespaceroutines.html#a8f2a013c7bb06da429f995e288515248" title="Subroutine to evaluate the Fermi energy at a given density and effective mass, for neutrons or proton..." alt="" coords="589,1503,728,1529"/>
<area shape="rect" id="node44" href="namespacepairing.html#a693cac2cfa7fcb7ad19984fefe20495c" title="Subroutine to perform BCS for protons. " alt="" coords="359,855,497,881"/>
<area shape="rect" id="node47" href="namespaceroutines.html#ad51ac6c5da6056a5346d7b15b3fbe7b4" title="Subroutine to write proton single particle energies to file, and extra details if BCS has been perfor..." alt="" coords="365,1007,491,1049"/>
<area shape="rect" id="node48" href="namespacestrutinsky.html#a7a348b225e6556c53687ee28ee31b316" title="Subroutine to calculate the Strutinsky shell correction energy for isospin . First, sum over occupied states of s.p. energies. Second, integrate over W&#45;S cell of smoothed ETF densities and fields. " alt="" coords="355,601,501,628"/>
<area shape="rect" id="node51" href="namespacestrutinsky.html#a2cc0d4130d68c345ffe3ffa73706e796" title="Subroutine to calculate the Strutinsky shell correction energy for protons, using BCS occupation prob..." alt="" coords="365,1226,491,1267"/>
<area shape="rect" id="node52" href="namespaceroutines.html#a81e61269fb96b5478fd7140a1f185ec1" title="Subroutine to write neutron and proton densities to files. " alt="" coords="347,1124,509,1151"/>
<area shape="rect" id="node53" href="namespaceroutines.html#a4a59953c814b7fa48f2c4bf31d1763a2" title="Subroutine to write neutron and proton fields to files. " alt="" coords="357,1175,499,1201"/>
<area shape="rect" id="node6" href="namespaceroutines.html#a407a248748ce7c0e2e9e5dce03cc9415" title="Function to calculate the neutron or proton density at a given radius r, using supplied input paramet..." alt="" coords="589,980,728,1007"/>
<area shape="rect" id="node16" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b" title="routines::str2int" alt="" coords="1054,1343,1166,1369"/>
<area shape="rect" id="node30" href="namespaceroutines.html#afb83677ec76758dadc35de4b01bac45c" title="Subroutine to calculate the charge density from the matter densities. Modified by M..." alt="" coords="601,1081,716,1108"/>
<area shape="rect" id="node9" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8" title="Function to integrate a density or field over the whole W&#45;S cell, using Simpson&#39;s rule (+ Simpson&#39;s 3..." alt="" coords="817,980,959,1007"/>
<area shape="rect" id="node11" href="namespaceroutines.html#af143340288720f8019e944ec7110a84e" title="Subroutine to extrapolate back 3 points on the r mesh, to faciliate the calculation of first and seco..." alt="" coords="818,442,958,483"/>
<area shape="rect" id="node12" href="namespaceroutines.html#a92e52c281532c938dfa10d85404a367a" title="This subroutine computes the first derivative of function evaluated on the meshpoints 1..." alt="" coords="843,508,933,535"/>
<area shape="rect" id="node13" href="namespaceroutines.html#a635a2461a6c20207dd3b268842381ce3" title="Subroutine to carry out Laplacian in spherical symmetry. " alt="" coords="803,173,973,200"/>
<area shape="rect" id="node14" href="namespaceroutines.html#aafc8447e9af12216ae995f63c1606f1a" title="This subroutine computes the second derivative of function evaluated on the meshpoints 1..." alt="" coords="1065,249,1155,276"/>
<area shape="rect" id="node15" href="namespaceroutines.html#a701f911aa939448c5bee0589d57369ca" title="Subroutine to calculate the effective mass ratio &#160;for neutrons or protons, for standard Skyrme or for..." alt="" coords="825,660,951,687"/>
<area shape="rect" id="node17" href="namespaceroutines.html#a8c520afea1e9ca6698a0792fbac37e7a" title="Function to calculate the spin&#45;orbit field &#160;for neutrons or protons. " alt="" coords="823,559,953,585"/>
<area shape="rect" id="node18" href="namespaceroutines.html#af03f37f9deca52ef9a56287f50b982a1" title="Subroutine to calculate the second&#45;order contributions to the spin current density &#160;for neutrons or p..." alt="" coords="819,609,957,636"/>
<area shape="rect" id="node19" href="namespaceroutines.html#a136b7a1f0387466390decb98ce91c152" title="Subroutine to calculate the second&#45;order contributions to the divergence of the current density &#160;for ..." alt="" coords="826,57,950,98"/>
<area shape="rect" id="node20" href="namespaceroutines.html#ac563b00969cb307d71ebc02aaef0a3b4" title="Subroutine to calculate third derivative of function f evaluated on evenly&#45;spaced meshpoints from 1 t..." alt="" coords="843,123,933,149"/>
<area shape="rect" id="node21" href="namespaceroutines.html#a6d38e9b19f2e939feb7840d2575fbb56" title="Subroutine to calculate fourth derivative of function f evaluated on evenly&#45;spaced meshpoints from 1 ..." alt="" coords="843,224,933,251"/>
<area shape="rect" id="node22" href="namespaceroutines.html#a014fed5fe5fbc19302e7cbc651ba59bd" title="Subroutine to calculate the fourth&#45;order contributions to the spin current density &#160;for neutrons or p..." alt="" coords="819,275,957,301"/>
<area shape="rect" id="node23" href="namespaceroutines.html#a7f66729f05be35eda4266dbf47eda026" title="Subroutine to calculate the fourth&#45;order contributions to the divergence of the current density &#160;for ..." alt="" coords="826,377,950,418"/>
<area shape="rect" id="node25" href="namespaceroutines.html#a421a5d2cca448f46b0dfb9bcdeec1111" title="Function to calculate the zeroth&#45;order contribution to the kinetic energy density for neutrons or pro..." alt="" coords="818,879,958,905"/>
<area shape="rect" id="node26" href="namespaceroutines.html#aaa80f6938f2b9c661821fa8956f8deef" title="Function to calculate the local second&#45;order contribution to the kinetic energy density for neutrons ..." alt="" coords="813,929,963,956"/>
<area shape="rect" id="node27" href="namespaceroutines.html#a72bf2988651a9f3251dfb338ad1a7eca" title="Subroutine to calculate the non&#45;local second&#45;order contribution to the kinetic energy density for neu..." alt="" coords="810,711,966,737"/>
<area shape="rect" id="node28" href="namespaceroutines.html#a9c7e02754e0ae8816b1bfeab92df6bc8" title="Subroutine to calculate the fourth&#45;order contributions to the kinetic energy density (without spin&#45;or..." alt="" coords="825,762,951,803"/>
<area shape="rect" id="node29" href="namespaceroutines.html#a8825f02bb2ac98507fff5024d9b54c8f" title="Subroutine to calculate the fourth&#45;order contributions to the kinetic energy density (spin&#45;orbit cont..." alt="" coords="808,828,968,855"/>
<area shape="rect" id="node34" href="namespaceroutines.html#a2a44c591985c939162dabdeab4a4ced8" title="Function to calculate the central potential &#160;for neutrons or protons, for standard Skyrme or for BSk ..." alt="" coords="824,1527,952,1553"/>
<area shape="rect" id="node39" href="namespacepairing.html#abad69eb8cb33077add1b9da84bff7c55" title="Function to calculate the pairing gap in infinite neutron matter, for specified density and effective..." alt="" coords="599,1401,719,1428"/>
<area shape="rect" id="node40" href="namespacepairing.html#aebb21947c7228a3fb9a092edfa226662" title="Function to calculate the interaction strength for the effective contact pairing force. Modified by M. Shelley. " alt="" coords="796,1031,980,1057"/>
<area shape="rect" id="node42" href="namespacepairing.html#ab022f3dcf7994e9f95315b3b2007a9ee" title="Function to calculate the pairing cutoff for the effective contact pairing force. ..." alt="" coords="1053,1159,1167,1185"/>
<area shape="rect" id="node41" href="namespacepairing.html#aaa0b619b1e454229caef01a56d0a61fd" title="Function to calculate the pairing gap using the analytical BSk expression. Modified by M..." alt="" coords="1028,1031,1192,1057"/>
<area shape="rect" id="node45" href="namespacestrutinsky.html#a106e8ec285383b5042e8436a2376147a" title="Subroutine to sort single particle states by their energies. Use bubble sort. " alt="" coords="586,483,731,509"/>
<area shape="rect" id="node46" href="namespacepairing.html#a37440fb2ff0d8a3495d051f3f14c9107" title="Function to solve gap equation at given chemical potential &quot;mu_p&quot;, returning the (BCS) number of prot..." alt="" coords="575,929,742,956"/>
<area shape="rect" id="node49" href="namespacerspace.html#af32fb6df1b49e330db5a70e2b05faa5b" title="rspace::boundary" alt="" coords="597,432,720,459"/>
<area shape="rect" id="node50" href="namespacerspace.html#a95f8e6b75776b923eb4ab9cc71a3be33" title="rspace::numerov" alt="" coords="829,5,947,32"/>
</map>
</div>

</div>
</div>
<a id="a48fed0623ded12967501f647461fb1cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48fed0623ded12967501f647461fb1cb">&#9670;&nbsp;</a></span>total_energy_with_corrections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine etf::total_energy_with_corrections </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>write_files_print_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to evaluate all WS quantities using supplied profile parameters, and calculate total energy, with pairing and shell corrections included. Write densities and fields to files, and all info to screen, if specified. </p>
<dl class="section author"><dt>Author</dt><dd>M. Shelley </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">write_files_print_info</td><td>Whether to write to files and screen </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="etf_8f90_a48fed0623ded12967501f647461fb1cb_cgraph.png" border="0" usemap="#etf_8f90_a48fed0623ded12967501f647461fb1cb_cgraph" alt=""/></div>
<map name="etf_8f90_a48fed0623ded12967501f647461fb1cb_cgraph" id="etf_8f90_a48fed0623ded12967501f647461fb1cb_cgraph">
<area shape="rect" id="node2" href="namespaceroutines.html#a93de76f3b26ead66893f46dc4892dbcb" title="Subroutine to evaluate the various densities, fields, derivatives, energies, and particle numbers in ..." alt="" coords="248,939,435,965"/>
<area shape="rect" id="node34" href="namespacepairing.html#ac34989a934af1e6a63131c619426c5aa" title="Subroutine to calculate the pairing energy for the WS cell, using the method specified in &quot;input..." alt="" coords="274,1403,409,1429"/>
<area shape="rect" id="node35" href="namespaceroutines.html#a8f2a013c7bb06da429f995e288515248" title="Subroutine to evaluate the Fermi energy at a given density and effective mass, for neutrons or proton..." alt="" coords="503,1403,641,1429"/>
<area shape="rect" id="node40" href="namespacestrutinsky.html#a6eeba7570095328226f37df3e89b7a18" title="Subroutine to allocate + initialise variables needed in &#39;boundary&#39; routine, and allocate arrays neede..." alt="" coords="269,1555,413,1597"/>
<area shape="rect" id="node41" href="namespacepairing.html#a693cac2cfa7fcb7ad19984fefe20495c" title="Subroutine to perform BCS for protons. " alt="" coords="272,1504,411,1531"/>
<area shape="rect" id="node44" href="namespaceroutines.html#ad51ac6c5da6056a5346d7b15b3fbe7b4" title="Subroutine to write proton single particle energies to file, and extra details if BCS has been perfor..." alt="" coords="279,1621,404,1662"/>
<area shape="rect" id="node45" href="namespacestrutinsky.html#a7a348b225e6556c53687ee28ee31b316" title="Subroutine to calculate the Strutinsky shell correction energy for isospin . First, sum over occupied states of s.p. energies. Second, integrate over W&#45;S cell of smoothed ETF densities and fields. " alt="" coords="268,1453,415,1480"/>
<area shape="rect" id="node48" href="namespacestrutinsky.html#a2cc0d4130d68c345ffe3ffa73706e796" title="Subroutine to calculate the Strutinsky shell correction energy for protons, using BCS occupation prob..." alt="" coords="279,1239,404,1281"/>
<area shape="rect" id="node49" href="namespaceroutines.html#a81e61269fb96b5478fd7140a1f185ec1" title="Subroutine to write neutron and proton densities to files. " alt="" coords="260,1687,423,1713"/>
<area shape="rect" id="node50" href="namespaceroutines.html#a4a59953c814b7fa48f2c4bf31d1763a2" title="Subroutine to write neutron and proton fields to files. " alt="" coords="270,1737,413,1764"/>
<area shape="rect" id="node51" href="namespacestrutinsky.html#a0a07c6adfd14cbf345bf96b70d3f5d82" title="Subroutine to deallocate arrays needed in &#39;boundary&#39; routine, and deallocate arrays needed for BCS..." alt="" coords="269,1789,413,1830"/>
<area shape="rect" id="node3" href="namespaceroutines.html#a407a248748ce7c0e2e9e5dce03cc9415" title="Function to calculate the neutron or proton density at a given radius r, using supplied input paramet..." alt="" coords="503,1048,641,1075"/>
<area shape="rect" id="node4" href="namespaceparameters.html#a55242f635842d12dbb53d66ae9248b93" title="Subroutine to initialise Skyrme force parameters with values for a given force specified in &#39;input..." alt="" coords="483,1099,661,1125"/>
<area shape="rect" id="node5" href="namespaceroutines.html#a0b8346e8e5457d6befb48b0ac56f4fdf" title="Subroutine to calculate the number of particles in the Wigner&#45;Seitz cell. " alt="" coords="497,931,647,973"/>
<area shape="rect" id="node7" href="namespaceroutines.html#aa995449a9eb9c404dbd756bdbea180a2" title="Subroutine to evaluate matter density derivatives, and all fields: effective masses (and derivatives)..." alt="" coords="503,367,641,393"/>
<area shape="rect" id="node13" href="namespaceroutines.html#a8146fb4359e556bad19f882b8aabfc4b" title="routines::str2int" alt="" coords="967,763,1079,789"/>
<area shape="rect" id="node21" href="namespaceroutines.html#a97bfcff7e603cf9df3dcd48ae21b4612" title="Subroutine to calculate the kinetic energy density &#160;with the (extended) Thomas&#45;Fermi approximation at..." alt="" coords="499,1352,645,1379"/>
<area shape="rect" id="node27" href="namespaceroutines.html#afb83677ec76758dadc35de4b01bac45c" title="Subroutine to calculate the charge density from the matter densities. Modified by M..." alt="" coords="515,997,629,1024"/>
<area shape="rect" id="node28" href="namespaceroutines.html#a74ed186c93b400a14428192e1cb7a0b2" title="Subroutine to evaluate the Coulomb potentials and energy densities, using either the proton or charge..." alt="" coords="494,1149,650,1176"/>
<area shape="rect" id="node29" href="namespaceroutines.html#a0b55cc503c7168299be63556e2602bd0" title="Subroutine to evaluate the proton&#45;electron potential which contributes to , all energy contributions..." alt="" coords="492,880,652,907"/>
<area shape="rect" id="node30" href="namespaceroutines.html#a6ee5e5cd7ce81b013d18b19f5f9a4092" title="Subroutine to evaluate the central fields . " alt="" coords="508,712,636,739"/>
<area shape="rect" id="node32" href="namespaceroutines.html#ae210968d134fbcc79297971cc4fefb82" title="Subroutine to evaluate the Skyrme energy density, after first separately evaluating the field energy ..." alt="" coords="497,814,647,855"/>
<area shape="rect" id="node33" href="namespaceroutines.html#a383e2bf5a1fa37fbf95dd5f6ddbcc6be" title="Subroutine to calculate the nuclear contribution to the pressure, and then the total pressure..." alt="" coords="509,763,635,789"/>
<area shape="rect" id="node6" href="namespaceroutines.html#a5737b4327dcaa959a9ee519e4fca42e8" title="Function to integrate a density or field over the whole W&#45;S cell, using Simpson&#39;s rule (+ Simpson&#39;s 3..." alt="" coords="730,1133,873,1160"/>
<area shape="rect" id="node8" href="namespaceroutines.html#af143340288720f8019e944ec7110a84e" title="Subroutine to extrapolate back 3 points on the r mesh, to faciliate the calculation of first and seco..." alt="" coords="731,57,871,98"/>
<area shape="rect" id="node9" href="namespaceroutines.html#a92e52c281532c938dfa10d85404a367a" title="This subroutine computes the first derivative of function evaluated on the meshpoints 1..." alt="" coords="756,224,847,251"/>
<area shape="rect" id="node10" href="namespaceroutines.html#a635a2461a6c20207dd3b268842381ce3" title="Subroutine to carry out Laplacian in spherical symmetry. " alt="" coords="716,173,887,200"/>
<area shape="rect" id="node11" href="namespaceroutines.html#aafc8447e9af12216ae995f63c1606f1a" title="This subroutine computes the second derivative of function evaluated on the meshpoints 1..." alt="" coords="978,148,1069,175"/>
<area shape="rect" id="node12" href="namespaceroutines.html#a701f911aa939448c5bee0589d57369ca" title="Subroutine to calculate the effective mass ratio &#160;for neutrons or protons, for standard Skyrme or for..." alt="" coords="739,611,864,637"/>
<area shape="rect" id="node14" href="namespaceroutines.html#a8c520afea1e9ca6698a0792fbac37e7a" title="Function to calculate the spin&#45;orbit field &#160;for neutrons or protons. " alt="" coords="736,341,867,368"/>
<area shape="rect" id="node15" href="namespaceroutines.html#af03f37f9deca52ef9a56287f50b982a1" title="Subroutine to calculate the second&#45;order contributions to the spin current density &#160;for neutrons or p..." alt="" coords="732,392,871,419"/>
<area shape="rect" id="node16" href="namespaceroutines.html#a136b7a1f0387466390decb98ce91c152" title="Subroutine to calculate the second&#45;order contributions to the divergence of the current density &#160;for ..." alt="" coords="739,443,863,485"/>
<area shape="rect" id="node17" href="namespaceroutines.html#ac563b00969cb307d71ebc02aaef0a3b4" title="Subroutine to calculate third derivative of function f evaluated on evenly&#45;spaced meshpoints from 1 t..." alt="" coords="756,509,847,536"/>
<area shape="rect" id="node18" href="namespaceroutines.html#a6d38e9b19f2e939feb7840d2575fbb56" title="Subroutine to calculate fourth derivative of function f evaluated on evenly&#45;spaced meshpoints from 1 ..." alt="" coords="756,560,847,587"/>
<area shape="rect" id="node19" href="namespaceroutines.html#a014fed5fe5fbc19302e7cbc651ba59bd" title="Subroutine to calculate the fourth&#45;order contributions to the spin current density &#160;for neutrons or p..." alt="" coords="732,5,871,32"/>
<area shape="rect" id="node20" href="namespaceroutines.html#a7f66729f05be35eda4266dbf47eda026" title="Subroutine to calculate the fourth&#45;order contributions to the divergence of the current density &#160;for ..." alt="" coords="739,275,863,317"/>
<area shape="rect" id="node22" href="namespaceroutines.html#a421a5d2cca448f46b0dfb9bcdeec1111" title="Function to calculate the zeroth&#45;order contribution to the kinetic energy density for neutrons or pro..." alt="" coords="731,1403,871,1429"/>
<area shape="rect" id="node23" href="namespaceroutines.html#aaa80f6938f2b9c661821fa8956f8deef" title="Function to calculate the local second&#45;order contribution to the kinetic energy density for neutrons ..." alt="" coords="727,1184,876,1211"/>
<area shape="rect" id="node24" href="namespaceroutines.html#a72bf2988651a9f3251dfb338ad1a7eca" title="Subroutine to calculate the non&#45;local second&#45;order contribution to the kinetic energy density for neu..." alt="" coords="723,1235,879,1261"/>
<area shape="rect" id="node25" href="namespaceroutines.html#a9c7e02754e0ae8816b1bfeab92df6bc8" title="Subroutine to calculate the fourth&#45;order contributions to the kinetic energy density (without spin&#45;or..." alt="" coords="739,1286,864,1327"/>
<area shape="rect" id="node26" href="namespaceroutines.html#a8825f02bb2ac98507fff5024d9b54c8f" title="Subroutine to calculate the fourth&#45;order contributions to the kinetic energy density (spin&#45;orbit cont..." alt="" coords="721,1352,881,1379"/>
<area shape="rect" id="node31" href="namespaceroutines.html#a2a44c591985c939162dabdeab4a4ced8" title="Function to calculate the central potential &#160;for neutrons or protons, for standard Skyrme or for BSk ..." alt="" coords="737,712,865,739"/>
<area shape="rect" id="node36" href="namespacepairing.html#abad69eb8cb33077add1b9da84bff7c55" title="Function to calculate the pairing gap in infinite neutron matter, for specified density and effective..." alt="" coords="512,1504,632,1531"/>
<area shape="rect" id="node37" href="namespacepairing.html#aebb21947c7228a3fb9a092edfa226662" title="Function to calculate the interaction strength for the effective contact pairing force. Modified by M. Shelley. " alt="" coords="709,1555,893,1581"/>
<area shape="rect" id="node39" href="namespacepairing.html#ab022f3dcf7994e9f95315b3b2007a9ee" title="Function to calculate the pairing cutoff for the effective contact pairing force. ..." alt="" coords="967,1605,1080,1632"/>
<area shape="rect" id="node38" href="namespacepairing.html#aaa0b619b1e454229caef01a56d0a61fd" title="Function to calculate the pairing gap using the analytical BSk expression. Modified by M..." alt="" coords="941,1555,1105,1581"/>
<area shape="rect" id="node42" href="namespacestrutinsky.html#a106e8ec285383b5042e8436a2376147a" title="Subroutine to sort single particle states by their energies. Use bubble sort. " alt="" coords="499,1605,645,1632"/>
<area shape="rect" id="node43" href="namespacepairing.html#a37440fb2ff0d8a3495d051f3f14c9107" title="Function to solve gap equation at given chemical potential &quot;mu_p&quot;, returning the (BCS) number of prot..." alt="" coords="489,1453,655,1480"/>
<area shape="rect" id="node46" href="namespacerspace.html#af32fb6df1b49e330db5a70e2b05faa5b" title="rspace::boundary" alt="" coords="511,1555,633,1581"/>
<area shape="rect" id="node47" href="namespacerspace.html#a95f8e6b75776b923eb4ab9cc71a3be33" title="rspace::numerov" alt="" coords="742,1656,861,1683"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="etf_8f90_a48fed0623ded12967501f647461fb1cb_icgraph.png" border="0" usemap="#etf_8f90_a48fed0623ded12967501f647461fb1cb_icgraph" alt=""/></div>
<map name="etf_8f90_a48fed0623ded12967501f647461fb1cb_icgraph" id="etf_8f90_a48fed0623ded12967501f647461fb1cb_icgraph">
<area shape="rect" id="node2" href="etf_8f90.html#a77a926a33d4e2b4d7c47fa641fc32e57" title="Program to calculate the equation of state in the inner crust with the extended Thomas&#45;Fermi (ETF) ap..." alt="" coords="248,5,287,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="etf_8f90.html">etf.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
